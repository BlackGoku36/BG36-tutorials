<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js dark">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>BG-36's Tutorials | Armory</title>
        
        <meta name="robots" content="noindex" />
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="The example book covers examples.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "dark";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('dark')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="a.html"><strong aria-hidden="true">1.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="GettingStarted/Introduction.html"><strong aria-hidden="true">1.1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="GettingStarted/Setup.html"><strong aria-hidden="true">1.2.</strong> Setup</a></li><li class="chapter-item expanded "><a href="GettingStarted/PitAndMis.html"><strong aria-hidden="true">1.3.</strong> Pitfall and Misconception</a></li></ol></li><li class="chapter-item expanded "><a href="a.html"><strong aria-hidden="true">2.</strong> Basics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Basics/Canvas.html"><strong aria-hidden="true">2.1.</strong> Canvas</a></li><li class="chapter-item expanded "><a href="Basics/Navmesh.html"><strong aria-hidden="true">2.2.</strong> Navmesh</a></li><li class="chapter-item expanded "><a href="Basics/Tilesheet.html"><strong aria-hidden="true">2.3.</strong> Tilesheet</a></li><li class="chapter-item expanded "><a href="Basics/Trait.html"><strong aria-hidden="true">2.4.</strong> Trait</a></li></ol></li><li class="chapter-item expanded "><a href="a.html"><strong aria-hidden="true">3.</strong> Mechanism</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Mechanism/SaveLoad/Introduction.html"><strong aria-hidden="true">3.1.</strong> Save and Load Mechanism</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Mechanism/SaveLoad/SL-1.html"><strong aria-hidden="true">3.1.1.</strong> Read/Write file</a></li><li class="chapter-item expanded "><a href="Mechanism/SaveLoad/SL-2.html"><strong aria-hidden="true">3.1.2.</strong> Save/Load game file</a></li><li class="chapter-item expanded "><a href="Mechanism/SaveLoad/SL-3.html"><strong aria-hidden="true">3.1.3.</strong> UI</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="a.html"><strong aria-hidden="true">4.</strong> Game Demo</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="GameDemo/CitySim/Introduction.html"><strong aria-hidden="true">4.1.</strong> City Sim</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="GameDemo/CitySim/Basics.html"><strong aria-hidden="true">4.1.1.</strong> Basics</a></li><li class="chapter-item expanded "><a href="GameDemo/CitySim/Resources.html"><strong aria-hidden="true">4.1.2.</strong> Resources</a></li><li class="chapter-item expanded "><a href="GameDemo/CitySim/UI.html"><strong aria-hidden="true">4.1.3.</strong> UI</a></li><li class="chapter-item expanded "><a href="GameDemo/CitySim/FAQ.html"><strong aria-hidden="true">4.1.4.</strong> FAQ</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="HowToRead.html">How-to read</a></li><li class="chapter-item expanded affix "><a href="FAQ.html">FAQ</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="dark">Dark (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">BG-36's Tutorials | Armory</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        <a href="https://github.com/BlackGoku36/BG36-tutorials/tree/master" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#getting-started" id="getting-started">Getting Started</a></h1>
<h1><a class="header" href="#introduction" id="introduction">Introduction</a></h1>
<hr />
<h2><a class="header" href="#armory3d" id="armory3d">ARMORY3D</a></h2>
<p>Armory3D is <a href="https://en.wikipedia.org/wiki/Data-driven_programming">data-driven</a> 3D engine written in <a href="https://en.wikipedia.org/wiki/Haxe"><code>Haxe</code></a>, <a href="https://en.wikipedia.org/wiki/C_(programming_language)"><code>C</code></a> and <a href="https://en.wikipedia.org/wiki/WebAssembly"><code>WebAssembly</code></a>, comes with Blender embedding but is designed to be able to be integrated into almost any 3d modelling and animation tool like <a href="https://en.wikipedia.org/wiki/Blender_(software)">Blender</a>. It's main focus is on performance, portability and minimal footprint.</p>
<h3><a class="header" href="#rendering" id="rendering">RENDERING</a></h3>
<p>Armory has it own renderer (see Iron). Armory uses Cycles/EEVEE material nodes to build <a href="https://en.wikipedia.org/wiki/Shader">shaders</a>. The <a href="https://en.wikipedia.org/wiki/Graphics_pipeline">renderpath</a> is completely scriptable, with support of forward and deferred renderpath out-of-box. It is completely possible to write your own shaders(in <a href="https://en.wikipedia.org/wiki/OpenGL_Shading_Language">glsl</a>).</p>
<h3><a class="header" href="#scripting" id="scripting">SCRIPTING</a></h3>
<p>Scripting is done with <code>traits</code>(a concept developed in <code>Iron</code>: <em>a piece of logic attached to an object</em>).</p>
<p>There are 4 different <code>Traits</code>:</p>
<ol>
<li><strong>LOGIC NODES TRAIT</strong>: Traits can be written with <code>Logic Node</code>(similar to UE4's Blueprints)</li>
<li><strong>HAXE TRAIT</strong>: Traits can be written in <code>Haxe</code>.</li>
<li><strong>CANVAS TRAIT</strong>: Trait for <code>Canvas UI</code></li>
<li><strong>WEBASSEMBLY(WASM) TRAIT</strong>: Trait written in WebAssembly, <code>Rust</code>/<code>C</code>/<code>C++</code> can be used to write logic in after compiling it to WASM.</li>
</ol>
<h3><a class="header" href="#targets" id="targets">TARGETS</a></h3>
<p>Armory support all targets that Kha support. Platform such as <code>Desktop(MacOS, Linux, Windows)</code>, <code>HTML5</code>, <code>Mobile(Android, iOS)</code> and <code>consoles(PS4, Xbox One, Switch)</code> is supported out-of-box.</p>
<hr />
<h2><a class="header" href="#technologies" id="technologies">Technologies</a></h2>
<h3><a class="header" href="#haxe" id="haxe">HAXE</a></h3>
<p><a href="https://haxe.org/"><strong>HAXE</strong></a> is open source cross-platform toolkit based on modern, high-level, strictly typed, multi-paradigm programming language and cross-compiler that can compile code to target platform native source code or binary. Haxe is easy-to-learn if you know java/AS3 and other OOP languages.</p>
<p>(So basically, Haxe will cross-compile you code to many different language such as Python, C++, Java, Lua, etc., and then you run/compile this cross-compiled code. It is useful if you want to create cross-platform app/games. So, many birds with one stone.)</p>
<h3><a class="header" href="#kha" id="kha">KHA</a></h3>
<p><a href="http://kha.tech/"><strong>KHA</strong></a> is ultra-portable, high performance, open-source multimedia framework. It is low level SDK for building cross-platform games and media applications. With the help of Haxe Programming language and the <a href="https://github.com/Kode/krafix">Krafix shader-compiler</a> it can cross-compile your code and optimize your assets. Kha gives you a common API to graphics, audio, input, and networking, for platforms such as Web, Mobile, Desktop, Consoles, <a href="https://github.com/Kode/Kha/wiki/Features#supported-platforms">etc</a> and Graphics APIs such as Metal, Vulkan, DirectX, WebGL and OpenGL.</p>
<p>(So basically, Kha is SDL on steroid which you can use to create Engines/Games/Apps, it will use platform native Graphics API, in order to maximum utilise GPU, resulting in fast, light-weight product)</p>
<h3><a class="header" href="#iron" id="iron">IRON</a></h3>
<p><a href="https://github.com/armory3d/iron"><strong>IRON</strong></a> is data-based, asynchronous engine used for building 3D tools, It is built with Kha, Haxe and WebAssembly. It is core engine of Armory but is designed to run stand-alone. Iron handles render &amp; content pipelines and lets you develop a custom visual engine on top of it.</p>
<p>(So basically, Iron is an engine, you can use it with other libs such as <a href="https://pybullet.org/wordpress/">Bullet</a> for your need.)</p>
<h3><a class="header" href="#downloading-the-add-on" id="downloading-the-add-on">Downloading the add-on</a></h3>
<h4><a class="header" href="#git" id="git">Git</a></h4>
<p>Installing Armory using Git is easy task.</p>
<ol>
<li>Get <a href="https://www.blender.org/download/">Blender</a> if you don't already have.</li>
<li>Open Terminal/Command Prompt, locate directory where the Blender is.</li>
<li>Enter following command:</li>
</ol>
<pre><code class="language-bash">git clone --recursive https://github.com/armory3d/armsdk
cd armsdk
git submodule foreach --recursive git pull origin master
</code></pre>
<ol start="4">
<li>Follow <code>Installing the add-on</code> steps.</li>
</ol>
<h4><a class="header" href="#itchio" id="itchio">Itch.io</a></h4>
<ol>
<li>Go to <a href="https://armory.itch.io/armory3d">itch.io</a>, and then download <code>ArmorySDK-20XX-XX.zip</code></li>
<li>Unpack it and place it where ever you want.</li>
<li>Follow <code>Installing the add-on</code> steps.</li>
</ol>
<hr />
<h3><a class="header" href="#installing-the-add-on" id="installing-the-add-on">Installing the add-on</a></h3>
<p><img src="GettingStarted/../setup_1.png" alt="Some Image" /></p>
<ol>
<li>Open Blender, go to <code>Edit - Preference</code>, <code>Blender Preference</code> should open, click <code>install</code>, locate the armsdk and select <code>armory.py</code> and click <code>install Add-on from File..</code> and save preference(Three dash icon from bottom left corner)</li>
<li>Restart Blender, and head back to preference and go to <code>Render: Armory</code> add-on, and to <code>Preferences - SDK Path</code> and enter the your path to armsdk, and then finally save it again.</li>
<li>Restart the Blender again and Armory's new UIs should be there.</li>
</ol>
<hr />
<h3><a class="header" href="#updating-the-add-on" id="updating-the-add-on">Updating the add-on</a></h3>
<ol>
<li>Go to Armory add-on tab and then click <code>Update SDK</code>.</li>
<li>Open terminal/command prompt and check the progress, when it is done, it should say <code>Armory is successfully updated. Restart Blender</code>.</li>
<li>Restart Blender</li>
</ol>
<h3><a class="header" href="#pitfalls" id="pitfalls">Pitfalls</a></h3>
<details>
    <summary> I am using Blender 2.7...</summary>
<p style="margin-left: 35px">Let me stop you right there, Armory now uses Blender 2.8 and support for Blender 2.7X is dropped, If you want to use Blender 2.7x, you will have to use Armory version < 0.6, you can find it [here](https://github.com/armory3d/armory/releases). So, move on like I did.</p>
</details>
<hr />
<details>
    <summary>I made changes to my game. Why donâ€™t they show up when I start the game?</summary>
<p style="margin-left: 35px">Armory caches builds of the game. Sometimes you need to clean this cache, click `Clean` button next to `Play` button under `Render Tab` in `Armory Player`, or if you don't want to clean build everytime, you can entirely disable it by `Render Tab - Armory Project - Flags` and unselect `Cache Build`.</p>
</details>
<hr />
<details>
    <summary>My mesh look all weird, how do I fix this?</summary>
<p style="margin-left: 35px">That issue is because of triangulation bug, try clean building.</p>
</details>
<hr />
<details>
    <summary>Error says that it can't find some file</summary>
<p style="margin-left: 35px">Make sure your blend file isn't directly exposed to any drive and also check if your folder's name doesn't have any illegal characters.</p>
</details>
<hr />
<h3><a class="header" href="#misconceptions" id="misconceptions">Misconceptions</a></h3>
<hr />
<details>
    <summary>I choosed `EEVEE`/`Cycles` renderer but still get this error</summary>
<p style="margin-left: 35px">It doesn't matter which renderer you select, Armory has it own renderer, and `EEVEE`/`Cycles`/`Workbench` aren't used by Armory at all.</p>
</details>
<hr />
<h1><a class="header" href="#getting-started-1" id="getting-started-1">Getting Started</a></h1>
<blockquote style="border-color: #DA0B50;">
    <p>
    THIS IS DATED! ARMORY2D HAS EVOLVED A LOT SINCE WRITING THIS!
    </p>
</blockquote>
<p>In this tutorial, we will create canvas using Armory2D, learn about it and then add and control canvas's element using <code>haxe</code>.</p>
<p>Our Goal:</p>
<iframe width="640" height="480" src="https://blackgoku36.github.io/BG36-tutorials/Armory/src/finalcanvas.mp4" frameborder="0" allowfullscreen></iframe>
<hr />
<p>Fire up Armory3D project, once you have it up, go to <code>Scene - Armory Scene Trait</code>, create new <code>Canvas Trait</code>, name it <code>UI</code> and hit <code>Edit Canvas</code>. A window named Armory2D should pop-up:</p>
<p><img src="Basics/../armory2D.png" alt="Armory2d Image" /></p>
<hr />
<p>Let study its user interface:</p>
<p><img src="Basics/../CanvasLayout.png" alt="Canvas's Layout Image" /></p>
<ol>
<li>
<p>This is where you can add elements from.</p>
</li>
<li>
<p>This is <code>Canvas</code>'s area, where you arrange for you window.</p>
</li>
<li>
<p>This is <code>Project</code> tab, where you configure you elements.</p>
<ol>
<li><code>Save</code>: Saves the canvas.</li>
<li><code>Canvas</code>: Create new canvas with given name, width and height.</li>
<li><code>Outliner</code>: This is layer. You can press <code>Up</code>/<code>Down</code> to move it up/down the layer, <code>Remove</code> to remove the element, <code>Duplicate</code>, to duplicate. (Pretty obvious)</li>
<li><code>Properties</code>: Adjust visibility, name, text, transform, color of an selected element.</li>
<li><code>Align</code>: <em>(WIP)</em>.</li>
<li><code>Anchor</code>: Anchor element to selected side.</li>
<li><code>Script</code>: This is used to handle event.</li>
<li><code>Timeline</code>: <em>(WIP)</em>.</li>
</ol>
</li>
<li>
<p>This is <code>Assets</code> tab, where you import assets in:</p>
<ol>
<li><code>Import Assets</code>: Import assets using zui's file dialogue.</li>
<li><code>X</code>: Remove assets.</li>
</ol>
</li>
<li>
<p>This is <code>Preferences</code> tab, where you configure Armory2D:</p>
<ol>
<li><code>UI Scale</code>: Scales the UI.</li>
<li><code>Grid Size</code>: Scale the grid.</li>
<li><code>Grid Snap Position:</code> Snap element to grid position.</li>
<li><code>Grid Snap Bounds:</code> Snap element to grid bounds.</li>
<li><code>VSync</code>: Enable/disable <a href="https://en.wikipedia.org/wiki/Screen_tearing">VSync</a>.</li>
<li><code>Console</code>: <em>(WIP)</em>.</li>
</ol>
</li>
<li>
<p>This is Timeline, used to animate elements, but currently it is WIP, so we will ignore it for now.</p>
</li>
</ol>
<p>Let add elements:</p>
<p><img src="Basics/../canvas_2.png" alt="Some Image" /></p>
<ol>
<li><code>Text</code>: Add Text <code>txt</code>, We will control this by using below UI (sliders, input, etc).</li>
<li><code>Sliders</code>: Add 3 sliders <code>slider_r</code>, <code>slider_g</code>, <code>slider_b</code> to control rgb value of the <code>txt</code>.</li>
<li><code>Input</code>: Add input <code>input_txt</code>, we will use this to controll the text of <code>txt</code>.</li>
<li><code>Combo</code>: Add combo(aka dropdown), set text as <code>Default Case;Upper Case;Lower Case</code>,we will use it make our <code>txt</code> case-sensitive or not.</li>
<li><code>Radio</code>: Add radio, <code>rotate</code>, set text as <code>Rotate 90;Rotate 180;Rotate 0</code>,we will use this set rotation of our text.</li>
<li><code>Check</code>: Add checkbox <code>visibility</code>, we will use this to make <code>txt</code> visible/invisible.</li>
<li><code>Button</code>: Add button <code>apply_btn</code>, and set <code>apply_btn</code> in <code>Script - Event</code>,we will use this to apply the change made using UI.</li>
<li><code>Image</code>: Add <code>logo</code>, we use this to for image assets.</li>
<li><code>Shape</code>: Add <code>h_1</code>, we use this add shape.</li>
</ol>
<blockquote style="border-color: #2c93c4;">
    <p>
    We set text of our combo and radio as `option1;option2;option3` because it seperate options by `;`.
    </p>
</blockquote>
<p>When you run the game, you should see something like this:</p>
<p><img src="Basics/../canvas_3.png" alt="Some Image" /></p>
<hr />
<p>Now, we will create <code>Haxe Trait</code> to control our UI created in <code>UI</code> Canvas. Head over to <code>Scene - Armory Scene Trait</code> in Blender and create new <code>Haxe Trait</code> and name it <code>CanvasController</code> and hit <code>Edit Script</code>.</p>
<pre><code class="language-haxe">// In CanvasController.hx
package arm;

import iron.Scene;
import armory.trait.internal.CanvasScript;
import armory.system.Event;

class CanvasController extends iron.Trait {

    // Initialize canvas as CanvasScript.
    var canvas:CanvasScript;

    public function new() {
        super();

        notifyOnInit(function() {
            // Set canvas as CanvasScript trait from active scene.
            canvas = Scene.active.getTrait(CanvasScript);
            // Add event listener with string 'apply_btn' and call 'applyCanvas' function.
            Event.add(&quot;apply_btn&quot;, applyCanvas);
        });

    }

    public function applyCanvas() {
        trace(&quot;Applied!&quot;);
    }
}
</code></pre>
<p>If you were to run this and press <code>Apply</code> button, it should print <code>Applied!</code>. If it do, then our basics are working and we are ready to do more work.</p>
<p>Now to change color of text using <code>slider_r</code>/<code>slider_g</code>/<code>slider_b</code> silder and enable/disable visibility using <code>visibility</code> checkbox:</p>
<pre><code class="language-haxe">//In CanvasController.hx
~

import kha.Color;
import zui.Canvas.TElement;
~
class CanvasController extends iron.Trait {

    var canvas:CanvasScript;
    // Initialize text as TElement.
    var text:TElement;

    public function new() {
        super();

        notifyOnInit(function() {
            canvas = Scene.active.getTrait(CanvasScript);
            //get element from canvas with string 'txt'.
            text = canvas.getElement(&quot;txt&quot;);
            Event.add(&quot;apply_btn&quot;, applyCanvas);
        });
    }

    public function applyCanvas() {
        //Only call set_'s funtions when button is pressed.
        set_rgb();
        set_visibility();
    }

    public function set_rgb() {
        //Get value from UI using getHandle().
        var r = canvas.getHandle(&quot;slider_r&quot;).value;
        var g = canvas.getHandle(&quot;slider_g&quot;).value;
        var b = canvas.getHandle(&quot;slider_b&quot;).value;
        //Set text color from float r,g,b.
        text.color = Color.fromFloats(r, g, b);
    }

    public function set_visibility() {
        //Get checkbox's selected bool value.
        var is_selected = canvas.getHandle(&quot;visibility&quot;).selected;
        // if isn't selected than keep invisible else visible.
        if (!is_selected){
            text.visible = false;
        }else{
            text.visible = true;
        }
    }
}
</code></pre>
<p>Now we will get input from <code>input_txt</code> and case sensitivity from <code>dd_case</code> and set Text <code>txt</code> according to it.</p>
<pre><code class="language-haxe">//In CanvasContoller.hx
~
class CanvasController extends iron.Trait {
    ~
    public function new() { ~ }

    public function applyCanvas() {
        set_rgb();
        set_visibility();
        set_input_txt();// 4
    }

    public function set_rgb() { ~ }

    public function set_visibility() { ~ }

    public function set_input_txt() {
        //Get input value.
        var input_txt = canvas.getHandle(&quot;input_txt&quot;).text;
        //Get selected value from drop down with position.
        var caseSensitivity = canvas.getHandle(&quot;dd_case&quot;).position;
        // 3
        if (caseSensitivity == 1){
            text.text = input_txt.toUpperCase();
        }else if (caseSensitivity == 2){
            text.text = input_txt.toLowerCase();
        }else{
            text.text = input_txt;
        }
    }
}
</code></pre>
<p>And lastly rotation of Text <code>txt</code> using Radio <code>visibility</code>:</p>
<pre><code class="language-haxe">~
class CanvasController extends iron.Trait {
    ~
    public function new() { ~ }

    public function applyCanvas() {
        ~
        set_rotation();
    }

    public function set_rgb() { ~ }

    public function set_visibility() { ~ }

    public function set_input_txt() { ~ }

    public function set_rotation(){
        //Just like dropdown's case use position to get selected value.
        var rotate = canvas.getHandle(&quot;rotate&quot;).position;
        //Set text's rotation according to selected radio's value.
        if (rotate == 0){
            text.rotation = 0;
        }else if (rotate == 1){
            text.rotation = 90 * 3.14 / 180;
        }else if (rotate == 2){
            text.rotation = 180 * 3.14 / 180;
        }
    }
}
</code></pre>
<blockquote style="border-color: #2c93c4;">
    <p>
    Armory uses radians almost everywhere so be sure to convert it to degrees.
    </p>
</blockquote>
<p>Now on playing it, you should get our goal.</p>
<p><strong>ðŸŽ‰There we go, our tutorial is finished ðŸŽ‰</strong></p>
<hr />
<p>If anything goes wrong, then you can check the <a href="https://github.com/BlackGoku36/armory-tutorial-download/tree/master/Canvas">source code</a></p>
<h2><a class="header" href="#navmesh-video" id="navmesh-video">Navmesh (Video)</a></h2>
<hr />
<p>A beginner level tutorial on the NavMesh functionality in the Armory3d engine.</p>
<p>In this <code>navmesh</code> video tutorial, Samuel Moxham (Smxham) will re-create Pac-Man while showing how to use navmash for this purpose.</p>
<iframe width="640" height="480" src="https://blackgoku36.github.io/BG36-tutorials/Armory/src/navmesh_tutorial.mp4" frameborder="0" allowfullscreen></iframe>
<p><a href="https://www.youtube.com/watch?v=TuKX3ap-JMs">Youtube Link</a></p>
<h2><a class="header" href="#tilesheet-video" id="tilesheet-video">Tilesheet (Video)</a></h2>
<hr />
<p>In this <code>tilesheet</code> video tutorial, Samuel Moxham (Smxham) will cover following:</p>
<ol>
<li>Demo of what is currently possible with <code>tilesheets</code>.</li>
<li>Software example to make your own sprite sheet.</li>
<li>How to make explosion effect in Armory3D using <code>tilesheets</code>.</li>
<li>Applying <code>tilesheets</code> in game scenario.</li>
</ol>
<iframe width="640" height="480" src="https://blackgoku36.github.io/BG36-tutorials/Armory/src/tilesheet_tutorial.mp4" frameborder="0" allowfullscreen></iframe>
<p><a href="https://www.youtube.com/watch?v=kFXqIprtF2Y">Youtube Link</a></p>
<p>Tilesheet Samuel Moxham uses in his tutorial -&gt; <a href="https://github.com/BlackGoku36/armory-tutorial-sourcecode/blob/master/Tilesheet/ConcreteImpact.png">Conceret_Impact</a>, <a href="https://github.com/BlackGoku36/armory-tutorial-sourcecode/blob/master/Tilesheet/Explosion.png">Explosion</a></p>
<hr />
<p>If anything goes wrong, then you can check the <a href="https://github.com/BlackGoku36/armory-tutorial-download/tree/master/Tilesheet">source code</a></p>
<h2><a class="header" href="#traits" id="traits">Traits</a></h2>
<hr />
<p>In this tutorial, we will learn about what is Traits, what are different types, how to create them and rotate different cube from different traits.</p>
<p>Goal:</p>
<iframe width="640" height="480" src="https://blackgoku36.github.io/BG36-tutorials/Armory/src/trait_final.mp4" frameborder="0" allowfullscreen></iframe>
<hr />
<p><code>Trait</code> is conecpt in <code>Iron</code> means a piece of logic attached to object or scene.</p>
<p>There are 4 different types of <code>traits</code>:</p>
<ol>
<li>
<p><strong>Haxe Trait</strong>: <a href="https://haxe.org/">Haxe</a> Text-based scripting trait that can be used to write game-play logic in.</p>
</li>
<li>
<p><strong>Logic Nodes Trait</strong>: Visual scripting trait for writing game-play logic in. It is similar to <a href="https://docs.unrealengine.com/en-US/Engine/Blueprints/index.html">UE4's Blueprints</a>.</p>
</li>
<li>
<p><strong>Canvas Trait</strong>: Trait for UI, canvas can be made using <a href="https://github.com/armory3d/armory2d">Armory2D</a>, but since it use <code>Json</code>, you can create layout yourself without <code>Armory2D</code>.</p>
</li>
<li>
<p><strong>WebAssembly(WASM)</strong>: <a href="https://webassembly.org/">WebAssembly</a> can also be used as scripting trait, It can be written in <a href="https://www.rust-lang.org/"><code>Rust</code></a>/<a href="https://en.wikipedia.org/wiki/C_%28programming_language%29"><code>C</code></a>/<a href="https://en.wikipedia.org/wiki/C%2B%2B"><code>C++</code></a> and than complied to <code>WASM</code> to use it in Armory <em>(WASM will only work with Krom target)</em>.
WASM is very useful when it comes to plugins, you can use Libraries made in <code>Rust</code>/<code>C</code>/<code>C++</code> and compile it to WASM and then use it in <code>Armory</code> and <code>Kha</code>. Two examples that are used in <code>ArmorPaint</code>: <a href="https://twitter.com/luboslenco/status/1173942414966439938">Texture-synthesis(Rust)</a>, <a href="https://twitter.com/luboslenco/status/1172536139573538816">Chips(C)</a>.</p>
</li>
</ol>
<hr />
<p>Let's get started, fire up armory3D project.
We will create Trait in following order:</p>
<ol>
<li><a href="Basics/Trait.html#haxe">Haxe</a></li>
<li><a href="Basics/Trait.html#logic-node">Logic Node</a></li>
<li><a href="Basics/Trait.html#wasm">Wasm</a></li>
<li><a href="Basics/Trait.html#canvas">Canvas</a></li>
</ol>
<h3><a class="header" href="#haxe-1" id="haxe-1">Haxe</a></h3>
<p>Create a cube, name it <code>Haxe</code> and place it wherever you want. Select it and go to <code>Scene - Armory Scene Trait</code>.</p>
<ol>
<li>Click <code>+</code>, select <code>Haxe</code> and click <code>OK</code>, <code>Haxe</code> trait placeholder should appear.</li>
<li>Click <code>New Script</code> and name the script of your choice, just make sure the first letter is capital(<code>HaxeScript</code> for me).</li>
<li>Finally hit <code>Edit Script</code>, you system default IDE should now open up with the project.</li>
</ol>
<p>Edit the script:</p>
<pre><code class="language-haxe">// In HaxeScript.hx
package arm;

//Imports
import iron.object.Object;
import iron.math.Vec4;
import iron.Scene;

class HaxeScript extends iron.Trait {
    //Initialise haxeCube as Object
    var haxeCube:Object;

    public function new() {
        super();
        //NotifyOnInit function get excuted when the 'trait' is initiated.
        notifyOnInit(function() {
            //Get haxeCube Object from active Scene.
            haxeCube = Scene.active.getChild(&quot;Haxe&quot;);
        });

        //NotifyOnUpdate function get excuted every frame.
        notifyOnUpdate(function() {
            //Rotate haxeCube with Vec4(x, y, z) and speed.
            haxeCube.transform.rotate(new Vec4(0.0, 0.0, 1.0), 0.01);
        });
    }
}
</code></pre>
<p>Now, if you were to play it, you should see <code>Haxe</code> cube rotating!.</p>
<h3><a class="header" href="#logic-node" id="logic-node">Logic Node</a></h3>
<p>Create a cube, name it <code>Nodes</code> and place it wherever you want. Select it and go to <code>Scene - Armory Scene Trait</code>.</p>
<ol>
<li>Click <code>+</code>, select <code>Nodes</code> and click <code>OK</code>, <code>Nodes</code> trait placeholder should appear.</li>
<li>Change your editor type to <code>Logic Node Editor</code> and click <code>+New</code>.</li>
<li>A node tree should be created, you can rename it by editing the text field(<code>LogicNodes</code> for me).</li>
<li>Go back to <code>Scene - Armory Scene trait</code>, select you logic nodes place holder and click <code>Tree</code>, select <code>LogicNodes</code> in dropdown.</li>
</ol>
<p>and now add following nodes(<code>Shift + A</code>):</p>
<p><img src="Basics/../traits_1.png" alt="Some Image" /></p>
<ol>
<li>On Update: It is triggered every tick.</li>
<li>Rotate object on axis, speed is set directly in vector.</li>
</ol>
<p>Now if you play it, <code>Nodes</code> cube should start spinnig.</p>
<h3><a class="header" href="#wasm" id="wasm">Wasm</a></h3>
<p>Create a cube, name it <code>Wasm</code> and place it wherever you want. Select it and go to <code>Scene - Armory Scene Trait</code>.</p>
<ol>
<li>Click <code>+</code>, select <code>Wasm</code> and click <code>OK</code>, <code>Wasm</code> trait placeholder should appear.</li>
<li>Click <code>New Module</code>, and it should re-direct you to <a href="https://webassembly.studio/">WebAssembly Studio</a>, select <code>Empty Rust Project</code>(you can select c/c++ too) and click <code>Create</code>.</li>
<li>Enter <code>Rust</code>/<code>C</code>/<code>C++</code> code and click <code>Build</code> and there should be <code>main.wasm</code> in <code>out</code> folder, right-click and download it.</li>
<li>Put outputed <code>main.wasm</code> in <code>Bundled</code> folder (create one, if there is no bundled folder).</li>
<li>Go back to <code>Scene - Armory Scene Trait</code>, select previously created <code>Wasm</code> placeholder, click <code>Refresh</code> and select <code>main</code> in <code>Module</code> dropdown.</li>
</ol>
<pre><code class="language-rs">// Rust example of rotating cube
// main.rs
extern {
    fn notify_on_update(f: extern fn() -&gt; ()) -&gt; ();
    fn get_object(name: *const i8) -&gt; i32;
    fn set_transform(object: i32, x: f32, y: f32, z: f32, rx: f32, ry: f32, rz: f32, sx: f32, sy: f32, sz: f32) -&gt; ();
}

#[no_mangle]
pub extern &quot;C&quot; fn update() -&gt; () {
    unsafe {
        let name = std::ffi::CString::new(&quot;Wasm&quot;).unwrap();
        let object = get_object(name.as_ptr());
        static mut rot: f32 = 0.1;
        rot += 0.01;
        set_transform(object, 0.0, 0.0, 0.0, 0.0, 0.0, rot, 0.5, 0.5, 0.5);
    }
}

#[no_mangle]
pub extern &quot;C&quot; fn main() -&gt; i32 {
    unsafe {
        notify_on_update(update);
    }
    return 0;
}
</code></pre>
<p>Now if you play it then you should have spinny rusty wasm cube.</p>
<h3><a class="header" href="#canvas" id="canvas">Canvas</a></h3>
<ol>
<li>Click <code>+</code>, select <code>UI</code> and click <code>OK</code>, <code>Canvas</code> trait placeholder should appear.</li>
<li>Click <code>New Canvas</code> and enter the name and click <code>Edit Canvas</code>.</li>
<li>Add <code>Text</code> element and set text as <code>Hello World from Canvas!</code> and save it.</li>
</ol>
<p>If you play it now, you should see <code>Hello World from Canvas</code>.</p>
<p>Check <a href="Basics/docs/Basics/Canvas.html">Canvas tutorial</a> for more!</p>
<p><strong>ðŸŽ‰There we go! We covered the basics of Traits!ðŸŽ‰</strong></p>
<hr />
<p>If anything goes wrong, then you can check the <a href="https://github.com/BlackGoku36/armory-tutorial-sourcecode/tree/master/Traits">source code</a></p>
<h1><a class="header" href="#getting-started-2" id="getting-started-2">Getting Started</a></h1>
<h1><a class="header" href="#introduction-1" id="introduction-1">Introduction</a></h1>
<p>Save/load is one of the most important feature in game, whether it is single-player or multi-player game. In case of single-player, the game data can be saved to local drive, with encryption so that cheating is not made easy. On other hand, in multi-players game, game data is saved on the server hosted by the game development group.</p>
<p>Ever wondered how this is generally done? Well, Saving and loading mechanism can be done by simply writing data into file and reading from it. <a href="https://en.wikipedia.org/wiki/JSON">Json</a> and <a href="https://en.wikipedia.org/wiki/XML">Xml</a> file formats are popularly used for this purpose for small game. In commercial games, things such as file size, encryption, etc. need to be taken care of, but for this tutorial we will just be exporting and reading from json. I will leave other stuffs up to you.</p>
<p>This tutorial is divided into 3 parts:</p>
<ol>
<li>We will look into writing and reading file in-game.</li>
<li>Add saving and loading cube's properties.</li>
<li>UI for saving and loading the game.</li>
</ol>
<p>At the end, we get:</p>
<iframe width="640" height="480" src="https://blackgoku36.github.io/BG36-tutorials/Armory/src/save_load_final.mp4" frameborder="0" allowfullscreen> </iframe>
<p>If anything goes wrong, then you can check the <a href="https://github.com/BlackGoku36/armory-tutorial-download/tree/master/SaveLoadMechanism">source code</a></p>
<h1><a class="header" href="#part-1" id="part-1">Part-1</a></h1>
<p>We will implement basics of file reading and writing for <code>Krom</code> platform. For now, create <code>Bundled</code> folder in root directory, Armory uses this folder to store and read files such as canvas's json.</p>
<ol>
<li>Create a Haxe trait <code>SaveLoadMechanism</code>, we will put everything here.</li>
</ol>
<!-- tabs:start -->
<h4><a class="header" href="#saveloadmechanismhx" id="saveloadmechanismhx"><strong>SaveLoadMechanism.hx</strong></a></h4>
<pre><code class="language-haxe">
package arm;

class SaveLoadMechanism extends iron.Trait {
    public function new() {
        super();

        notifyOnInit(function() {
            //Only compile the code for krom platform
            #if kha_krom
            //Set json structure with text as 'hello World!'
            var saveData = { text: &quot;Hello World!&quot; };
            //Converts above structure to json string.
            var saveDataJSON = haxe.Json.stringify(saveData);
            //Get Krom's location path and add path for save_game.json.
            var path = Krom.getFilesLocation() + &quot;/save_game.json&quot;;
            //Write json string to bytes.
            var bytes = haxe.io.Bytes.ofString(saveDataJSON);
            //Save to file from path specified above with data from bytes.
            Krom.fileSaveBytes(path, bytes.getData());
            #end
        });

    }
}
</code></pre>
<hr />
<details>
    <summary>Code Explanation</summary>
<ol>
<li><code>#if some_condition</code> is called <a href="https://en.wikipedia.org/wiki/Conditional_compilation">Conditional Compiling</a> expression, here, our code will only be compiled to Krom platform.</li>
<li>We define structure and convert the structure into json.</li>
<li>We get Krom's file location (during playing from armory, krom's file location is <code>root_folder/build_file/debug/krom/save_game.json</code>) and append our <code>save_game.json</code> to the path.</li>
<li>Convert our stringy json to bytes.</li>
<li>Save data from bytes to path specified.</li>
</ol>
</details>
<hr />
<!-- tabs:end -->
<p>If you play and open <code>root_folder/build_file/debug/krom/</code> you should find <code>save_game.json</code> and it should have your saved content. To save it to <code>Bundled</code> folder that we previously create and to add keyboard input code to save manually instead of saving when the game initiate.</p>
<!-- tabs:start -->
<h4><a class="header" href="#saveloadmechanismhx-1" id="saveloadmechanismhx-1"><strong>SaveLoadMechanism.hx</strong></a></h4>
<pre><code class="language-haxe">package arm;
import iron.system.Input;

class SaveLoadMechanism extends iron.Trait {
    //Get keyboard's input.
    var kb = Input.getKeyboard();

    public function new() {
        super();

        notifyOnUpdate(function() {
            if(kb.started(&quot;f&quot;)){
                save();
            }
        });
    }

    public function save(){
        ~
        var saveDataJSON = haxe.Json.stringify(saveData);
        // Move out of 3 dirs
        var path = Krom.getFilesLocation() + &quot;/../../../&quot; + &quot;/Bundled/save_game.json&quot;;
        var bytes = haxe.io.Bytes.ofString(saveDataJSON);
        ~
        #end
    }
}
</code></pre>
<hr />
<details>
    <summary>Code Explanation</summary>
<ol>
<li>On every tick, check if key <code>f</code> is pressed, than call <code>save()</code></li>
<li>We add <code>/../../../</code> before path to move out of three directory.</li>
</ol>
</details>
<hr />
<!-- tabs:end -->
<p><img src="Mechanism/SaveLoad/../../save_load_4.png" alt="Some Image" /></p>
<p>We need to read from file in order to load its contents.</p>
<!-- tabs:start -->
<h4><a class="header" href="#saveloadmechanism" id="saveloadmechanism"><strong>SaveLoadMechanism</strong></a></h4>
<pre><code class="language-haxe">package arm;

import iron.system.Input;
import iron.data.Data;

class SaveLoadMechanism extends iron.Trait {

    var kb = Input.getKeyboard();
    var saveFile = &quot;save_game.json&quot;;
    public function new() {
        super();

        notifyOnUpdate(function() {
            if(kb.started(&quot;f&quot;)){
                save();
            }else if(kb.started(&quot;g&quot;)){
                load();
            }
        });
    }

    public function save() { ~ }

    public function load(){
        //Get Blob, from `Bundled`
        Data.getBlob(saveFile, function(bytes:kha.Blob) {
            //Converts bytes to string.
            var jsonString = bytes.toString();
            //Parse value from stringy json.
            var json = haxe.Json.parse(jsonString);
            trace(json.text);
        });
    }
}
</code></pre>
<hr />
<details>
    <summary>Code Explanation</summary>
<ol>
<li>Check if <code>f</code>, <code>g</code> is pressed and then call <code>save()</code>, <code>load()</code> respectively.</li>
<li>Load blob from path specified.</li>
<li>Convert the file to string and then parse json from it.</li>
</ol>
</details>
<hr />
<!-- tabs:end -->
<p>Hit <code>Play</code>, try pressing <code>f</code> and then <code>g</code>, <code>Hello World!</code> should appear in debug console, if it do than that means saving and loading works ðŸ‘Œ</p>
<p><img src="Mechanism/SaveLoad/../../save_load_6.png" alt="Some Image" /></p>
<h1><a class="header" href="#part-2" id="part-2">Part-2</a></h1>
<p>We can read and write from/to file. And now we will read and write our lovely default cube's properties, let just create a trait <code>CubeController</code> to simply rotate and move cube to demonstrate saving and loading.</p>
<pre><code class="language-haxe">// In CubeController.hx

package arm;

import iron.math.Vec4;
import iron.system.Input;

class CubeController extends iron.Trait {
    var kb = Input.getKeyboard();
    public function new() {
        super();

        notifyOnUpdate(function() {
            //Translates (x, y, z) object with according to the key press.
            if(kb.down(&quot;up&quot;)) object.transform.translate(-0.2, 0.0, 0.0);
            else if (kb.down(&quot;down&quot;)) object.transform.translate(0.2, 0.0, 0.0);
            else if (kb.down(&quot;left&quot;)) object.transform.translate(0.0, -0.2, 0.0);
            else if (kb.down(&quot;right&quot;)) object.transform.translate(0.0, 0.2, 0.0);
            //Rotate randomly with 0.1 speed.
            else if (kb.down(&quot;r&quot;)) object.transform.rotate(new Vec4(Math.random(), Math.random(), Math.random()), 0.1);
        });
    }
}
</code></pre>
<p>This should give you following result:</p>
<iframe width="480" height="360" src="https://blackgoku36.github.io/BG36-tutorials/Armory/src/save_load_8.mp4" frameborder="0"> </iframe>
<p>We use <code>typedef</code> structure to have it hold some of the cube's properties, and use this structure to save/load to json.</p>
<pre><code class="language-haxe">// In SaveLoadMechanism.hx

package arm;

import iron.Scene;
import iron.math.Vec4;
import iron.system.Input;
import iron.data.Data;

//Define Anonymous Structure with Vec4 location and rotation.
typedef Cube = { loc : Vec4, rot : Vec4 }

class SaveLoadMechanism extends iron.Trait {

    var kb = Input.getKeyboard();

    var saveFile = &quot;save_game.json&quot;;

    public function new() {
        super();

        notifyOnUpdate(function() {
            if(kb.started(&quot;f&quot;)){
                save();
            }else if(kb.started(&quot;g&quot;)){
                load();
            }
        });
    }
    public function save(){
        //Get 'Cube' from active Scene.
        var cube = Scene.active.getChild(&quot;Cube&quot;);
        //Get cube's location.
        var cubeLoc = cube.transform.loc;
        //Get cube's rotation.
        var cubeRot = new Vec4(cube.transform.rot.x, cube.transform.rot.y, cube.transform.rot.z);

        #if kha_krom
        //Set cube's loc and rot to anonymous structure defined above.
        var saveData: Cube = {loc: cubeLoc, rot: cubeRot};
        // Convert saveData to string.
        var saveDataJSON = haxe.Json.stringify(saveData);

        var path = Krom.getFilesLocation() + &quot;/../../../&quot; + &quot;/Bundled/save_game.json&quot;;
        // Get bytes of string
        var bytes = haxe.io.Bytes.ofString(saveDataJSON);
        // Save bytes's data to file
        Krom.fileSaveBytes(path, bytes.getData());
        trace(&quot;Saved!&quot;);
        #end
    }

    public function load() {
        var cube = Scene.active.getChild(&quot;Cube&quot;);
        // Loads blob from `Bundled` folder
        Data.getBlob(saveFile, function(b:kha.Blob) {

            var string = b.toString();
            var json = haxe.Json.parse(string);

            //Set cube's location and rotation.
            cube.transform.loc = json.loc;
            cube.transform.setRotation(json.rot.x, json.rot.y, json.rot.z);
            //builds matrix (kind of like applying changes).
            cube.transform.buildMatrix();
        });
    }
}
</code></pre>
<blockquote style="border-color: #FF9E1F;">
    <p>
    For now, we will have to reopen the game to let game parse newly overwritten game_save.json.
    </p>
</blockquote>
<p>You should get this as result:</p>
<iframe width="480" height="360" src="https://blackgoku36.github.io/BG36-tutorials/Armory/src/save_load_9.mp4" frameborder="0"> </iframe>
<p>If it work for you, then congrats! ðŸŽ‰</p>
<h1><a class="header" href="#part-2-1" id="part-2-1">Part-2</a></h1>
<p>Using keyboard to save and load game doesn't make sense, so we will add some buttons to do the work instead. Create a new scene Canvas trait <code>SaveLoad</code>  and add following elements and set their event as 'save_btn' and 'load_btn':</p>
<p><img src="Mechanism/SaveLoad/../../save_load_12.png" alt="Some Image" /></p>
<p>and if you play it, you should get something like this:</p>
<p><img src="Mechanism/SaveLoad/../../save_load_13.png" alt="Some Image" /></p>
<p>Now to make button click, open <code>SaveLoadMechanism.hx</code>.</p>
<pre><code class="language-haxe">// In SaveLoadMechanism.hx
package arm;

import armory.system.Event;
import iron.Scene;
                ~
class SaveLoadMechanism extends iron.Trait {
                ~
    public function new() {
        super();

        notifyOnInit(function(){
            //Add event listener with string defined in Armory2D.
            Event.add(&quot;save_btn&quot;, save);
            Event.add(&quot;load_btn&quot;, load);
        });

    }
                ~
</code></pre>
<p>For our last and final feature, we are going to hide buttons on start and then we will able to show and hide them with <code>m</code>.</p>
<pre><code class="language-haxe">// In SaveLoadMechanism.hx

            ~
import armory.trait.internal.CanvasScript;// 1

typedef Cube = { loc : Vec4, rot : Vec4 }

class SaveLoadMechanism extends iron.Trait {
                ~
    var canvas:CanvasScript;

    var isButtonsHidden:Bool;

    public function new() {
        super();

        notifyOnInit(function(){
            //Get CanvasScript trait from active scene.
            canvas = Scene.active.getTrait(CanvasScript);
            hideButtons();
            isButtonsHidden = true;
                        ~
        });

        notifyOnUpdate(function (){
            if (kb.started(&quot;m&quot;)){
                if (isButtonsHidden){
                    showButtons();
                }else{
                    hideButtons();
                }
            }
        });
    }

    public function save() { ~ }

    public function load() { ~ }

    public function hideButtons() {
        //Set Element visible property to false to hide the element
        canvas.getElement(&quot;save_btn&quot;).visible = false;
        canvas.getElement(&quot;load_btn&quot;).visible = false;
        isButtonsHidden = true;
    }

    public function showButtons() {
        //Set Element visible property to true to show the element
        canvas.getElement(&quot;save_btn&quot;).visible = true;
        canvas.getElement(&quot;load_btn&quot;).visible = true;
        isButtonsHidden = false;
    }
}
</code></pre>
<p>You should get the following result:</p>
<iframe width="640" height="480" src="https://blackgoku36.github.io/BG36-tutorials/Armory/src/save_load_final.mp4" frameborder="0" allowfullscreen> </iframe>
<p><strong>ðŸŽ‰There we go! Save and Load mechanism tutorial is over!ðŸŽ‰</strong></p>
<hr />
<p>For further improving, you can:</p>
<ol>
<li>Encrypt the file, so that people don't cheat.</li>
<li>Add more value for it to save.</li>
<li>Make GTA XII</li>
</ol>
<h1><a class="header" href="#getting-started-3" id="getting-started-3">Getting Started</a></h1>
<h2><a class="header" href="#introduction-2" id="introduction-2">Introduction</a></h2>
<hr />
<!-- **Quick introduction on Armory3D**: `Armory3D` is game engine integrated in `Blender` to provide excellent workflow from start to finish, it uses ultimate cross-platform tool-kit and framework that is `Haxe` and `Kha`.

**Quick introduction on City Building Simulator game genre**: `CBS` game is `city management` type game where you act as `Mayor` of the city you are building. One of the main concept of `CBS` game is simple, you build houses and get money from it, get resources such as wood, stones, etc from buildings such sawmill, quarry, etc. your main goal is to increase your city level *(keep in mind, that we are talking about small CBS game her, not the one made by AAA studios)*.

So, let make a small `CBS` game demo in `Armory3D`, but with little twist in concept. -->
<p>City Building Simulator (CBS) game, is a genre of simulation based video-games, where player act as the leader of city they are building. It is usually top-down game, where player choose buildings placements and other city management features to develop the city accordingly.</p>
<h3><a class="header" href="#concept" id="concept">CONCEPT</a></h3>
<ul>
<li>
<p><strong>Art type</strong>: Voxels <em>(those blocky things)</em></p>
</li>
<li>
<p><strong>Goal</strong>: Your goal is to keep your citizens happy, go below the line of happiness, and you lose.</p>
</li>
<li>
<p><strong>How this game work</strong>:</p>
<ul>
<li>You start playing the game with happiness at half.</li>
<li>Building such as Housing, Amusement park, small gardens, sports court increases happiness.</li>
<li>Building such as Sawmills, quarry, steelworks, powerplants increases pollution bar.</li>
<li>Pollution degrades parks, gardens, etc, and this make people unhappy.</li>
<li>You have to pay to maintain this parks, gardens, etc.</li>
</ul>
</li>
<li>
<p><strong>Building stuffs</strong>:</p>
</li>
</ul>
<table><thead><tr><th>Buildings</th><th align="center">Costs</th><th align="right">Produce</th></tr></thead><tbody>
<tr><td>House</td><td align="center">Woods, Stones, Steel, Electricity</td><td align="right">Money, Happiness</td></tr>
<tr><td>Parks</td><td align="center">Woods, Stones, Steel, Electricity</td><td align="right">Money, Happiness</td></tr>
<tr><td>Garden</td><td align="center">Woods, Stones, Steel</td><td align="right">Happiness</td></tr>
<tr><td>Sports court</td><td align="center">Woods, Stones, Steel</td><td align="right">Happiness</td></tr>
<tr><td>Sawmills</td><td align="center">Money, Electricity</td><td align="right">Woods, Pollution</td></tr>
<tr><td>Quarry</td><td align="center">Money, Electricity</td><td align="right">Stones, Pollution</td></tr>
<tr><td>Steelworks</td><td align="center">Money, Electricity</td><td align="right">Steel, Pollution</td></tr>
<tr><td>Powerplants</td><td align="center">Money</td><td align="right">Electricity, Pollution</td></tr>
</tbody></table>
<ul>
<li><strong>Features</strong>:</li>
</ul>
<table><thead><tr><th>In-game Feature</th><th>Tutorial's feature</th></tr></thead><tbody>
<tr><td>Game can be saved/loaded locally</td><td>Extend upon <a href="GameDemo/CitySim/docs/Save_Load_Mechanism/Save_Load_Mechanism.html">save/load tutorial</a> and add little encryption feature like, <a href="https://en.wikipedia.org/wiki/Caesar_cipher">Caesar chiper</a></td></tr>
<tr><td>Spawning, removing, selecting moving of building</td><td>Will uses physics and raycasting stuffs</td></tr>
<tr><td>Layout Editing</td><td>Handling of different scenes</td></tr>
<tr><td>Settings</td><td>Handling of screen size, graphics, etc. with UI</td></tr>
</tbody></table>
<p>A quick overview of this tutorial:</p>
<ol>
<li><code>Basic</code>: we will implement basics of our city building game such as placing, moving, etc with player interaction.</li>
</ol>
<p>Now before we go, make sure to start up armory and run it, to make sure everything is working correctly.</p>
<blockquote style="border-color: #DA0B50;">
    <p>
    Keep in mind that this tutorial is not fully done, this tutorial will change from time to time.
    </p>
</blockquote>
<h2><a class="header" href="#basics" id="basics">Basics</a></h2>
<hr />
<p>In <code>Basics</code> part we will establish basics of city buildings, such as placing, moving, etc of buildings with player interaction.</p>
<hr />
<p>Table of contents:</p>
<ul>
<li><a href="GameDemo/CitySim/docs/Game_Demo/City_Sim/Basics#Arcball-camera">Arcball Camera</a></li>
<li><a href="GameDemo/CitySim/docs/Game_Demo/City_Sim/Basics#Buildings">Buildings</a></li>
<li><a href="GameDemo/CitySim/docs/Game_Demo/City_Sim/Basics#Player">Player</a></li>
</ul>
<hr />
<h2><a class="header" href="#arcball-camera" id="arcball-camera">ARCBALL CAMERA</a></h2>
<p>To view around our scene's environment, we will use arcball camera rotation. Now, arcball rotation is <em>rotation of an object around a point</em>. We will arcball rotate the camera when right mouse button is pressed and hold and use mouse wheel to zoom in and out.</p>
<p>To do so:</p>
<ol>
<li>Create an empty <code>CameraEmpty</code> and position it to center of world and then set parent of our camera to this empty.</li>
<li>Create new haxe trait <code>CameraController</code> and assign it to our camera, we will use this to control behavior of our camera.</li>
</ol>
<!-- tabs:start -->
<h4><a class="header" href="#cameracontrollerhx" id="cameracontrollerhx"><strong>CameraController.hx</strong></a></h4>
<pre><code class="language-haxe">package arm;

import iron.Scene;
import iron.system.Input;
import iron.math.Vec4;

class CameraController extends iron.Trait {
    //Get our CameraEmpty
    var cameraEmpty = Scene.active.getEmpty(&quot;CameraEmpty&quot;).transform;
    //Get mouse
    var mouse = Input.getMouse();

    @prop
    var viewMin = 1.0;
    @prop
    var viewMax = 2.8;

    public function new() {
        super();
        notifyOnUpdate(update);
    }

    function update() {
        if(mouse.down(&quot;right&quot;)){
            // Rotate our empty on z-axis in opposite direction of our mouse-x movement.
            // Mouse movement is divided by 200 to slow the rotation.
            cameraEmpty.rotate(new Vec4(0, 0, 1), -mouse.movementX / 200);
            cameraEmpty.buildMatrix();
            cameraEmpty.rotate(object.transform.world.right(), -mouse.movementY / 200);
            cameraEmpty.buildMatrix();
        }

        if (mouse.wheelDelta != 0){
            //Add mouse wheel delta to cameraEmpty scale
            cameraEmpty.scale.add(new Vec4(mouse.wheelDelta/30, mouse.wheelDelta/30, mouse.wheelDelta/30));
            //Clamp the scale
            cameraEmpty.scale.clamp(viewMin, viewMax);
            cameraEmpty.buildMatrix();
        }
    }
}

</code></pre>
<hr />
<details>
    <summary>Code Explanation</summary>
<ol>
<li><code>@prop</code>, is used for variable that need configuration, if you refresh script than you can edit this variable straight from blender.</li>
<li>We get empty's transform and and set it z-axis rotation to reverse of our mouse moment on x-axis and slow it down by 200, and then <code>buildMatrix()</code>.</li>
<li>We rotate our empty again but on object's right location in world-space and with our mouse's moment on y-axis and again call <code>buildMatrix()</code>.</li>
<li>If mouse's wheel is moving, than add mouse's wheel delta to cameraEmpty's scale and slow it down by 30, thus adding zoom in and out.</li>
<li>Clamp the scale between viewMin and viewMax, so that camera can't zoom in and out more.</li>
</ol>
</details>
<hr />
<!-- tabs:end -->
<p>You should get this:</p>
<p><img src="GameDemo/CitySim/../../CBS_1.gif" alt="Some Image" /></p>
<hr />
<h2><a class="header" href="#buildings" id="buildings">BUILDINGS</a></h2>
<p>To manage our city, we will need to spawn, move, remove, rotate our buildings.</p>
<ol>
<li>
<p>Create a cube <code>hs</code>(stand for house), we will use this for assets, it will do nothing else of sort.</p>
</li>
<li>
<p>Create a plane <code>bld_1</code>(we will use numbers for types), and make <code>hs</code> as child to this plane, we will use this as base, and for interaction. Set its physics as:</p>
<ul>
<li>Physics type -&gt; RigidBody</li>
<li>RigidBody Type -&gt; Passive</li>
<li>Setting -&gt; Animated</li>
<li>Collision shape -&gt; Box</li>
<li>Collision Collection -&gt; 2nd Group</li>
<li>Collision Filter mask -&gt; 2nd Group</li>
</ul>
</li>
<li>
<p>Set plane (ground) physics as:</p>
<ul>
<li>Physics type -&gt; RigidBody</li>
<li>RigidBody Type -&gt; Passive</li>
<li>Collision shape -&gt; Box</li>
</ul>
</li>
</ol>
<blockquote style="border-color: #2c93c4;">
    <p>
    Collision filter mask will make ray-cast ignore the object.
    </p>
</blockquote>
<ol start="4">
<li>Create new Haxe trait <code>BuildingController</code> and assign it to scene.</li>
</ol>
<h3><a class="header" href="#selecting-and-unselecting" id="selecting-and-unselecting">SELECTING AND UNSELECTING</a></h3>
<p>We will interact with our building by selecting, unselecting building. To do so, We will physics ray-cast to group 2(groups of buildings) and check if it hit any of our building, if it do than set selected building to this.</p>
<!-- tabs:start -->
<h4><a class="header" href="#buildingcontrollerhx" id="buildingcontrollerhx"><strong>BuildingController.hx</strong></a></h4>
<pre><code class="language-haxe">import armory.trait.physics.PhysicsWorld;

import iron.Scene;
import iron.math.Vec4;
import iron.math.RayCaster;
import iron.system.Input;

//Define structure of building
typedef Building = {
    name: String,
    type: Int
}

class BuildingController extends iron.Trait {
    //Declare selectedBuilding, i.e., name of building currently selected.
    public static var selectedBuilding:Building = null;
    //Whether any building is selected or not
    public static var isBuildingSelected = false;

    public function new() {
        super();
    }

    public static function raySelectBuilding() {
        //Get rigid body from raycast from group 2.
        var rigidbody = getRaycast(2).rigidbody;
        //Check if rigidbody isn't null and rigidbody's name start with &quot;bld&quot;
        if(rigidbody != null &amp;&amp; StringTools.startsWith(rigidbody.object.name, &quot;bld&quot;)){
            //Set selected building to hit rigidbody name
            selectedBuilding = getBuildingFromString(rigidbody.object.name);
            isBuildingSelected = true;
        }else {
            selectedBuilding = null;
            isBuildingSelected = false;
        }
    }

    static function getRaycast(group:Int){
        var physics = PhysicsWorld.active;
        var mouse = Input.getMouse();
        var start = new Vec4();
        var end = new Vec4();
        var camera = Scene.active.getCamera(&quot;Camera&quot;);
        // Get Ray-cast direction from start to end with mouse's x, y and camera
        RayCaster.getDirection(start, end, mouse.x, mouse.y, camera);
        // cast ray from camera's location in world space to end vec and get hit result.
        var hit = physics.rayCast(camera.transform.world.getLoc(), end, group);
        var rigidbody = (hit != null) ? hit.rb : null;
        //wrap rigidbody and hit result and return it.
        return{
            rigidbody: rigidbody,
            hit: hit
        };
    }

    static function getBuildingFromString(name: String):Building {
        var building:Building = null;
        for(i in buildings){
            if (i.name == name) building = i;
        }
        return building;
    }

}
</code></pre>
<hr />
<details>
    <summary>Code Explanation</summary>
<ol>
<li>
<p>We define data structure of our building, that is its name and it type, with this it will be a lot easier to manage buildings(add, remove, etc).</p>
</li>
<li>
<p>We create <code>getBuildingFromString(*name*)</code>, we loop through all building and check if name match building's name, if so, return the building object.</p>
</li>
<li>
<p>We create <code>getRaycast(*group*)</code> specially, as we don't want to repeat this function during selecting and moving of building. This will ray-cast for specific group from camera to mouse's x/y location in world space, and get hit and rigidbody.</p>
</li>
<li>
<p>We create <code>raySelectBuilding()</code>, which will be use to ofc selected building, we will do so why using our getRaycast() and get rigidbody of hit object, if this rigidbody's name start with 'bld' then set selectedBuilding to this rigidbody name and set isBuildingSelected to true else, null and false.</p>
</li>
</ol>
</details>
<hr />
<!-- tabs:end -->
<h3><a class="header" href="#moving" id="moving">MOVING</a></h3>
<p>We will want to move building across ground to be able to place it wherever we like. For doing that, we will physics ray-cast to group 1 and check if it hit plane, if it do than update building position to ray's hit location every frame.</p>
<!-- tabs:start -->
<h4><a class="header" href="#buildingcontrollerhx-1" id="buildingcontrollerhx-1"><strong>BuildingController.hx</strong></a></h4>
<pre><code class="language-haxe">~
typedef Building = { ~ }
class BuildingController extends iron.Trait {
    ~
    //Should building move
    public static var buildingMove = false;

    public static function new() { ~ }
    public static function raySelectBuilding() { ~ }

    public static function moveBuilding() {
        var raycast = getRaycast(1);
        if(raycast.rigidbody != null &amp;&amp; raycast.rigidbody.object.name == &quot;Ground&quot;) {
            //Set loc of selected building as floor of ray hit position's x, y and z as 0.4.
            Scene.active.getChild(selectedBuilding.name).transform.loc.set(Math.floor(raycast.hit.pos.x), Math.floor(raycast.hit.pos.y), 0.2);
        }
    }

    static function getRaycast(group:Int){ ~ }
    static function getBuildingFromString(name: String):Building { ~ }
}
</code></pre>
<hr />
<details>
    <summary>Code Explanation</summary>
<ol>
<li>We then create <code>moveBuilding()</code>, to drag building around, we can do so, by ray-casting(<code>getRaycast()</code>) and get hit location and update building location each frame, we will floor the hit location for grid-snapping effect and set building's z-axis location to 0 as we don't want building to be higher or lower.</li>
</ol>
</details>
<hr />
<!-- tabs:end -->
<h3><a class="header" href="#placing-and-removing" id="placing-and-removing">PLACING AND REMOVING</a></h3>
<p>To be able to place building, we will first unselect any selected building, spawn new building and set selected building to new spawned one. To place it we will simply unselect our selected building. To remove building, we will select the building, than remove the building and then unselect building.</p>
<!-- tabs:start -->
<h4><a class="header" href="#buildingcontrollerhx-2" id="buildingcontrollerhx-2"><strong>BuildingController.hx</strong></a></h4>
<pre><code class="language-haxe">import iron.object.Object;
~
typedef Building = { ~ }

class BuildingController extends iron.Trait {
    ~
    //Declare arrays of buildings
    public static var buildings: Array&lt;Building&gt; = [];
    //Building's Id, eg: bld_hs1, bld_pw2, etc.
    public static var buildingId = 0;

    public function new() { ~ }
    public static function raySelectBuilding() { ~ }
    public static function moveBuilding() { ~ }

    public static function selectBuilding(name: String) {
        selectedBuilding = getBuildingFromString(name);
        isBuildingSelected = true;
        buildingMove = true;
    }

    public static function unselectBuilding() {
        selectedBuilding = null;
        isBuildingSelected = false;
        buildingMove = false;
    }

    public static function spawnBuilding(type: Int) {
        unselectBuilding();
        //Spawn object with name = &quot;bld_&quot;+type
        Scene.active.spawnObject(&quot;bld_&quot;+type, null, function(bld: Object){
            //Increment buildingID
            buildingId++;
            //Change name
            bld.name = &quot;bld_&quot;+type+&quot;_&quot;+buildingId;
            //Add new building to add with name and type
            buildings.push({
                name: &quot;bld_&quot;+type+&quot;_&quot;+buildingId,
                type: type
            });
            selectBuilding(bld.name);
        });
    }

    public static function removeBuilding() {
        //Remove Selected building
        Scene.active.getChild(selectedBuilding.name).remove();
        //Remove selected building from buildings array
        removefromArray(selectedBuilding.name, buildings);
        //Unselect building
        unselectBuilding();
    }

    static function getRaycast(group:Int){ ~ }
    static function getBuildingFromString(name: String):Building { ~ }

    static function removefromArray(name: String, buildings: Array&lt;Building&gt;){
        //Define building and set it to null
        var building:Building = null;
        //loop through buildings array
        for (i in buildings){
            //if building's name match, with name parameter
            if (i.name == name){
                //Set above declared building to this
                building = i;
            }
        }
        //Get index of building in buildings array
        var index = buildings.indexOf(building);
        //If it exist(doesn't exist = -1)
        if (index &gt; -1){
            //remove building from array from index and length
            buildings.splice(index, 1);
        }
    }
}

</code></pre>
<hr />
<details>
    <summary>Code Explanation</summary>
<ol>
<li>
<p>We creates <code>selectBuilding(*name*)</code> and we do so by setting selectedBuilding to <em>name</em>, isBuildingSelected to true, and buildingMove to true.</p>
</li>
<li>
<p>We creates <code>unselectBuilding()</code> and we do so by setting selectedBuilding, isBuildingSelected to null, false respectively.</p>
</li>
<li>
<p>We will now spawn building with <code>spawnBuilding(*type*)</code>, we will first spawn object and when it is spawned, we will increment buildingId, set it name to &quot;bld_&quot;+its type+ its buildingId, pushes this building to our buildings array and unselect any selected building and select this spawned building.</p>
</li>
<li>
<p>We will create a utility function <code>removefromArray(*name*, *buildings*)</code> to remove selectedBuilding from buildings array. we will loop through buildings array check if name matches, if it do then get index of this building in buildings array and then remove it with splice.</p>
</li>
<li>
<p>Now to remove building, we will create <code>removeBuilding()</code>, with it we will remove building object from game and then remove it from out buildings array and finally unselect building.</p>
</li>
</ol>
</details>
<hr />
<!-- tabs:end -->
<h3><a class="header" href="#rotating-and-on-contact" id="rotating-and-on-contact">ROTATING AND ON-CONTACT</a></h3>
<p>We will get contact between buildings to avoid putting them inside of each other. And also add rotation, because buildings can faced any side!.</p>
<!-- tabs:start -->
<h4><a class="header" href="#buildingcontrollerhx-3" id="buildingcontrollerhx-3"><strong>BuildingController.hx</strong></a></h4>
<pre><code class="language-haxe">import armory.trait.physics.RigidBody;
~
typedef Building = { ~ }

class BuildingController extends iron.Trait {
    ~
    //Is building in any contact
    public static var buildingInContact = false;

    public static function new() { ~ }
    public static function raySelectBuilding() { ~ }
    public static function moveBuilding() { ~ }
    public static function selectBuilding(name: String) { ~ }
    public static function unselectBuilding() { ~ }
    public static function spawnBuilding(type: String) { ~ }
    public static function removeBuilding() { ~ }

    public static function buildingContact() {
        var physics = PhysicsWorld.active;
        //Get contact of selected building
        var contact = physics.getContacts(Scene.active.getChild(selectedBuilding.name).getTrait(RigidBody));
        if (contact != null){
            buildingInContact = true;
        }else{
            buildingInContact = false;
        }
    }

    public static function rotateBuilding() {
        Scene.active.getChild(selectedBuilding.name).transform.rotate(Vec4.zAxis(), 1.57);
    }

    static function getRaycast(group:Int){ ~ }
    static function getBuildingFromString(name: String):Building { ~ }
    static function removefromArray(name: String, buildings: Array&lt;Buildings&gt;){ ~ }
}

</code></pre>
<hr />
<details>
    <summary>Code Explanation</summary>
<ol>
<li>
<p>To get contact of our buildings with any object that is rigidbody, we do so by creating <code>buildingContact()</code>, we get physics object that is in contact with our building's rigidbody, if there is any rigidbody contacting with our building, set buildingInContact to true, else false.</p>
</li>
<li>
<p>For last feature i.e. rotating, we will create <code>rotateBuilding()</code>, and rotate the building on z-axis by 1.57 in radians(90 degrees) every time this function is called.</p>
</li>
</ol>
</details>
<hr />
<!-- tabs:end -->
<h2><a class="header" href="#player" id="player">PLAYER</a></h2>
<h3><a class="header" href="#handling-buildings-controller" id="handling-buildings-controller">HANDLING BUILDINGS CONTROLLER</a></h3>
<p>We will need to let player control the buildings, such as moving, removing, etc.</p>
<ol>
<li>Create new Haxe trait <code>PlayerController</code>, we will use it as player interaction with game.</li>
</ol>
<!-- tabs:start -->
<h4><a class="header" href="#playercontrollerhx" id="playercontrollerhx"><strong>PlayerController.hx</strong></a></h4>
<pre><code class="language-haxe">import iron.system.Input;

//Import previously made BuildingController
import arm.BuildingController;

class PlayerController extends iron.Trait {

    var mouse = Input.getMouse();
    var kb = Input.getKeyboard();

    var building = BuildingController;
    var buildingType: Int = 1;

    public function new() {
        super();
        notifyOnUpdate(update);
    }

    function update() {
        if(!building.isBuildingSelected){
            if (mouse.started()){ //mouse.started() defaults to &quot;left&quot; if no button is provided.
                building.raySelectBuilding();
            }
            if (kb.started(&quot;p&quot;)){
                building.spawnBuilding(buildingType);
            }
        }else{
            if (mouse.started(&quot;right&quot;)) {
                if (!building.buildingInContact){
                    building.unselectBuilding();
                }
            }
            if (kb.started(&quot;m&quot;)){
                building.buildingMove = true;
            }else if (kb.started(&quot;f&quot;)){
                building.removeBuilding();
            }else if (kb.started(&quot;r&quot;)){
                building.rotateBuilding();
            }
        }

        if (building.buildingMove) {
            building.moveBuilding();
            building.buildingContact();
        }

        if (kb.started(&quot;1&quot;)) buildingType = 1;
        else if (kb.started(&quot;2&quot;)) buildingType = 2;
        else if (kb.started(&quot;3&quot;)) buildingType = 3;
        else if (kb.started(&quot;4&quot;)) buildingType = 4;
        else if (kb.started(&quot;5&quot;)) buildingType = 5;
        else if (kb.started(&quot;6&quot;)) buildingType = 6;
        else if (kb.started(&quot;7&quot;)) buildingType = 7;
        else if (kb.started(&quot;8&quot;)) buildingType = 8;
    }
}
</code></pre>
<hr />
<details>
    <summary>Code explanation</summary>
<ol>
<li>
<p>First we initialize some variables.</p>
</li>
<li>
<p>Call update function every frame.</p>
</li>
<li>
<p>Check if any building isn't selected, if not, then press left mouse button to select building and press <code>p</code> to spawn buildings. else if any building is selected, continuously check its contacts, if right mouse button is pressed than check if it is in any contact, if not then unselect building. If key button <code>m</code>, <code>f</code>, <code>r</code> is pressed, then move, remove, rotate building respectively.</p>
</li>
<li>
<p>Use number key button to select building type.</p>
</li>
</ol>
</details>
<hr />
<!-- tabs:end -->
<p>Putting it all together you should get:</p>
<p><img src="GameDemo/CitySim/../../CBS_1_F.gif" alt="Some Image" /></p>
<p>Now try creating more building such as gardens, parks, sawmills, etc and apply same physics as <code>bld_hs</code>, and replace cube buildings, with your own assets.</p>
<p><strong>ðŸŽ‰There we go! CBS's Basic part is over!ðŸŽ‰</strong></p>
<hr />
<p>If you have any problem then you can check the source code at <a href="https://github.com/BlackGoku36/CBST-A3D">CBST-A3D</a></p>
<hr />
<blockquote style="border-color: #DA0B50;">
    <p>
    W.I.P.
    </p>
</blockquote>
<h2><a class="header" href="#resources" id="resources">Resources</a></h2>
<hr />
<p>In <code>Resources</code>, we will involve resource producing and collecting from buildings.</p>
<p>Rechecking our concept, when we place buildings, we want it to produce some resources at cost of some other resources, here the small table from the concept:</p>
<table><thead><tr><th>Buildings</th><th>Costs</th><th>Produce</th></tr></thead><tbody>
<tr><td>House</td><td>Woods, Stones, Electricity</td><td>Money, Happiness</td></tr>
<tr><td>Parks</td><td>Woods, Stones, Electricity</td><td>Money, Happiness</td></tr>
<tr><td>Sawmills</td><td>Money, Electricity</td><td>Woods, Pollution</td></tr>
<tr><td>Quarry</td><td>Money, Electricity</td><td>Stones, Pollution</td></tr>
<tr><td>Powerplants</td><td>Money</td><td>Electricity, Pollution</td></tr>
</tbody></table>
<hr />
<p>Table of contents:</p>
<ul>
<li>
<p><strong>RESOURCES</strong></p>
<ul>
<li><a href="GameDemo/CitySim/docs/Game_Demo/City_Sim/Resources#building-properties-structure">Building properties structure</a></li>
<li><a href="GameDemo/CitySim/docs/Game_Demo/City_Sim/Resources#recalculate-buildings">Recalculate buildings</a></li>
<li><a href="GameDemo/CitySim/docs/Game_Demo/City_Sim/Resources#recalculate-resources">Recalculate resources</a></li>
<li><a href="GameDemo/CitySim/docs/Game_Demo/City_Sim/Resources#producing-resources">Producing resources</a></li>
</ul>
</li>
<li>
<p><a href="GameDemo/CitySim/docs/Game_Demo/City_Sim/Resources#canvas">Canvas</a></p>
</li>
</ul>
<hr />
<h2><a class="header" href="#resources-1" id="resources-1">RESOURCES</a></h2>
<p>Buildings will produce given amount of resources in given interval of time. We want to make:</p>
<ul>
<li>House produce 5 money every 5 sec at cost of 10 woods and 10 stones.</li>
<li>Sawmill produce 5 woods every 5 sec at cost of 10 money.</li>
<li>Quarry produce 5 stones every 5 sec at cost of 10 money.</li>
<li>Powerplant produce 10 electricity every 5 sec at cost of 20 money.</li>
<li>Electricity to be used by house, sawmill, quarry to produce their resources, if they don't get enough electricity, they stop production.</li>
</ul>
<p><em>(values are not absolute, it needed to be tweak for final game)</em></p>
<h3><a class="header" href="#building-properties-structure" id="building-properties-structure">BUILDING PROPERTIES STRUCTURE</a></h3>
<p>Let create proper structure of our building property, where we will store buildings properties such as maximum buildings allowed, cost, production, etc.</p>
<ol>
<li>Create new scene Haxe trait <code>WorldController</code>, this will act as our main world controller.</li>
</ol>
<!-- tabs:start -->
<h4><a class="header" href="#worldcontrollerhx" id="worldcontrollerhx"><strong>WorldController.hx</strong></a></h4>
<pre><code class="language-haxe">package arm;
//Building properties structure
typedef BuildingProp = {
    //at: how many building are there currently?, max: how many maximum buildings can be spawned?
    at:Int, max:Int,
    //Cost amount of money, wood, stones, electricity
    costM:Int, costW:Int, costS:Int, costE:Int,
    //Produce amount of money, woods, stones, electricity
    prodM: Int, prodW:Int, prodS:Int, prodE:Int,
    //Produce amount of happiness, pollution
    prodH:Int, prodP:Int,
    //Timetask id
    tt: Int
}

class WorldController extends iron.Trait {
    //Set houses prop
    public static var houseProp: BuildingProp = {
        at:0, max:2, costM: 0,costW:10, costS:10, costE:5, prodM: 5, prodW:0, prodS:0, prodE: 0, prodH:3, prodP:0, tt: 0
    };
    //Set parks prop
    public static var parkProp: BuildingProp = {
        at:0, max:2, costM: 0,costW:10, costS:10, costE:5, prodM: 5, prodW:0, prodS:0, prodE: 0, prodH:5, prodP:0, tt: 0
    };
    //Set sawmills prop
    public static var sawmillProp: BuildingProp = {
        at:0, max:2, costM: 10,costW:0, costS:0, costE:5, prodM: 0, prodW:5, prodS:0, prodE: 0, prodH:0, prodP:3, tt: 0
    };
    //Set quarrys prop
    public static var quarryProp: BuildingProp = {
        at:0, max:2, costM: 10, costW:0, costS:0, costE:5, prodM: 0, prodW:0, prodS:5, prodE: 0, prodH:0, prodP:3, tt: 0
    };
    //Set powerplants prop
    public static var powerplantProp: BuildingProp = {
        at:0, max:2, costM: 20, costW:0, costS:0, costE:0, prodM: 0, prodW:0, prodS:0, prodE: 10, prodH:0, prodP:5, tt: 0
    };

    public function new() {
        super();
    }
}

</code></pre>
<hr />
<details>
    <summary>Code Explanation</summary>
<ol>
<li>
<p>We create buildings properties structure to store information and fields which are not needed are set to '0' as we don't want to create structure for each building.</p>
</li>
<li>
<p>We set properties of buildings <code>houseProp</code>, <code>parkProp</code>, etc.</p>
</li>
</ol>
</details>
<hr />
<!-- tabs:end -->
<h3><a class="header" href="#recalculate-buildings" id="recalculate-buildings">RECALCULATE BUILDINGS</a></h3>
<p>We will recalculate buildings from buildings structure and set building properties structure and limit amount of particular buildings that can be spawned.</p>
<!-- tabs:start -->
<h4><a class="header" href="#buildingcontrollerhx-4" id="buildingcontrollerhx-4"><strong>BuildingController.hx</strong></a></h4>
<pre><code class="language-haxe">~
import arm.WorldController;

typedef Building = {~}
class BuildingController extends iron.Trait{
    ~
    public static var enoughBuildings = true;
    public function new(){~}
    ~
    public static function spawnBuilding(type: Int){
        var world = WorldController;
        //Check if this type of buildings reached max amount
        checkMaxBuilding(type);
        //If there is not enough building
        if(!enoughBuildings){
            Scene.active.spawnObject(&quot;bld_&quot;+type, null, function(bld: Object){
                ~
                buildings.push({~});
                //Recalculate amount of buildings
                recalculateBuildings();
                unselectBuilding();
                selectBuilding(bld.name);
            });
        }

    }
    public static function removeBuilding(){
        Scene.active.getChild(selectedBuilding).remove();
        removefromArray(selectedBuilding, buildings);
        //Recalculate amount of buildings
        recalculateBuildings();
        unselectBuilding();
    }
    ~
    static function recalculateBuildings(){
        var world = WorldController;
        //Create buildings type list
        //[House, parks,......, powerplant]
        var buildingList = [0, 0, 0, 0, 0, 0, 0, 0];
        for(building in buildings){
            switch (building.type){
                //Set increase building list by one of certain type
                case 1: buildingList[0] += 1;//House
                case 2: buildingList[1] += 1;//Park
                case 5: buildingList[4] += 1;//Sawmill
                case 6: buildingList[5] += 1;//Quarry
                case 8: buildingList[7] += 1;//Powerplant
            }
        }
        //Set 'at' of building property
        world.houseProp.at = buildingList[0];
        world.parkProp.at = buildingList[1];
        world.sawmillProp.at = buildingList[4];
        world.quarryProp.at = buildingList[5];
        world.powerplantProp.at = buildingList[7];
    }
    static function checkMaxBuilding(type:Int){
        var world = WorldController;
        switch(type){
            //Check if building of type reached max amount, then set enough buildings to true else false
            case 1: world.houseProp.at == world.houseProp.max ? enoughBuildings = true : enoughBuildings = false;
            case 2: world.parkProp.at == world.parkProp.max ? enoughBuildings = true : enoughBuildings = false;
            case 5: world.sawmillProp.at == world.sawmillProp.max ? enoughBuildings = true : enoughBuildings = false;
            case 6: world.quarryProp.at == world.quarryProp.max ? enoughBuildings = true : enoughBuildings = false;
            case 8: world.powerplantProp.at == world.powerplantProp.max ? enoughBuildings = true : enoughBuildings = false;
        }
    }
}
</code></pre>
<hr />
<details>
    <summary>Code Explanation</summary>
<ol>
<li>
<p>In <code>recalculateBuildings()</code>, we create array of building list, each index represent building type. Then we loop through our array of buildings and switch through building types and increase the building list by one if type matches. And finally set 'at' of our buildings property from building list.</p>
</li>
<li>
<p>In <code>checkMaxBuilding(*type*)</code>, we switch through types, if type match we check building of type's property and check if no. of buildings is same as maximum limit, if true than set enoughBuildings to true, else false.</p>
</li>
<li>
<p>In <code>spawnBuilding(*type*)</code>, check if maximum amount of buildings of particular type reached, if not true than allow to spawn, and then on spawning recalculate buildings again.</p>
</li>
<li>
<p>In <code>removeBuilding()</code>, recalculate buildings again after selected building is removed.</p>
</li>
</ol>
</details>
<hr />
<!-- tabs:end -->
<h3><a class="header" href="#recalculate-resources" id="recalculate-resources">RECALCULATE RESOURCES</a></h3>
<p>We will recalculate resources after we spawn the building, i.e., after spawning we subtract the building's resource cost from total resources. And we will also limit buildings from being spawned if total resource is less than building's resource cost.</p>
<!-- tabs:start -->
<h4><a class="header" href="#worldcontrollerhx-1" id="worldcontrollerhx-1"><strong>WorldController.hx</strong></a></h4>
<pre><code class="language-haxe">~
typedef BuildingProp = {~}

class WorldController extends iron.Trait {
    //Set resources with array -&gt; [at, max]
    public static var happiness:Array&lt;Int&gt; = [50, 100];
    public static var money:Array&lt;Int&gt; = [50, 100];
    public static var woods:Array&lt;Int&gt; = [50, 100];
    public static var stones:Array&lt;Int&gt; = [50, 100];
    public static var electricity:Array&lt;Int&gt; = [0, 100];

    public static var houseProp: BuildingProp = {~};
    public static var parkProp: BuildingProp = {~};
    public static var sawmillProp: BuildingProp = {~};
    public static var quarryProp: BuildingProp = {~};
    public static var powerplantProp: BuildingProp = {~};

    public function new(){~}

}
</code></pre>
<hr />
<details>
    <summary>Code Explanation</summary>
<ol>
<li>We set resources with array as [amount of this resource, maximum resource storeable].</li>
</ol>
</details>
<hr />
<h4><a class="header" href="#buildingcontrollerhx-5" id="buildingcontrollerhx-5"><strong>BuildingController.hx</strong></a></h4>
<pre><code class="language-haxe">~
typedef Building = {~}
class BuildingController extends iron.Trait{
    ~
    public static var enoughBuildings = true;
    public static var enoughResources = true;
    public function new(){~}
    ~
    public static function spawnBuilding(type: Int){
        var world = WorldController;
        checkMaxBuilding(type);
        //Check if resources reached max amount
        checkResources(type);
        //If there is not enough building and there is enough resource
        if(!enoughBuildings &amp;&amp; enoughResources){
            Scene.active.spawnObject(&quot;bld_&quot;+type, null, function(bld: Object){
                ~
                buildings.push({~});
                recalculateBuildings();
                //Recalculate amount of resources of this type
                recalculateResources(type);
                unselectBuilding();
                selectBuilding(bld.name);
            });
        }
    }
    public static function removeBuilding(){~}
    ~
    static function recalculateBuildings(){~}
    static function checkResources(type:Int){
        var world = WorldController;
        switch(type){
            case 1: (world.woods[0] &lt; world.houseProp.costW &amp;&amp; world.stones[0] &lt; world.houseProp.costS) ? enoughResources = false : enoughResources = true;
            case 5: (world.money[0] &lt; world.sawmillProp.costM) ? enoughResources = false : enoughResources = true;
            case 6: (world.money[0] &lt; world.quarryProp.costM) ? enoughResources = false : enoughResources = true;
            case 8: (world.money[0] &lt; world.powerplantProp.costM) ? enoughResources = false : enoughResources = true;
        }
    }
    static function recalculateResources(type:Int) {
        var world = WorldController;
        switch(type){
            case 1:
                world.woods[0] -= world.houseProp.costW;
                world.stones[0] -= world.houseProp.costS;
            case 5:
                world.money[0] -= world.sawmillProp.costM;
            case 6:
                world.money[0] -= world.quarryProp.costM;
            case 8:
                world.money[0] -= world.powerplantProp.costM;
        }
    }
    static function checkMaxBuilding(type:Int){~}
}
</code></pre>
<hr />
<details>
    <summary>Code Explanation</summary>
<ol>
<li>In <code>recalculateResources(*type*)</code>, We recalculate resources by subtracting cost from resources amount with given type.</li>
<li>In <code>checkResources(*type*)</code>, we check if resources available is less than the cost, if so, then we set enoughResources to true else false.</li>
<li>We check resources before spawning, if there is enough resources and not enough building then we spawn the building, when spawned we recalculate the resources.</li>
</ol>
</details>
<hr />
<!-- tabs:end -->
<h3><a class="header" href="#producing-resources" id="producing-resources">PRODUCING RESOURCES</a></h3>
<p>Now, we want buildings to produce resources at given interval. This can be simply done by using kha's Scheduler timetask.</p>
<!-- tabs:start -->
<h4><a class="header" href="#worldcontrollerhx-2" id="worldcontrollerhx-2"><strong>WorldController.hx</strong></a></h4>
<pre><code class="language-haxe">package arm;

import kha.Scheduler;

import arm.BuildingController;
import arm.MainCanvasController;

typedef BuildingProp = {~}

class WorldController extends iron.Trait {

    public static var money:Array&lt;Int&gt; = [50, 100];
    ~
    public static var electricity:Array&lt;Int&gt; = [0, 100];

    public static var houseProp: BuildingProp = {~};
    ~
    public static var powerplantProp: BuildingProp = {~};

    public function new() {
        super();
        notifyOnInit(init);
    }

    function init() {
        var world = WorldController;
        //Add timetask with interval of 5sec and assign timetask id to housett.
        houseProp.tt = Scheduler.addTimeTask(function(){
            //check electricity, if electricity is greater than cost and money amount is less than max money
            if (electricity[0] &gt;= world.houseProp.costE &amp;&amp; money[0] &lt; money[1]){
                // increase by (no.of houses x house money production.)
                money[0] += houseProp.at * houseProp.prodM;
                //Do clamping and handle overflowing
                if (money[0] &gt; money[1]) money[0] = money[1];
                //Multiply no. of houses * houses cost and subtract the product from electricity amount
                electricity[0] -= houseProp.at * houseProp.costE;
            }
        }, 5, 5);
        parkProp.tt = Scheduler.addTimeTask(function(){
            if (electricity[0] &gt;= world.parkProp.costE &amp;&amp; money[0] &lt; money[1]){
                money[0] += parkProp.at * parkProp.prodM;
                if (money[0] &gt; money[1]) money[0] = money[1];
                electricity[0] -= parkProp.at * parkProp.costE;
            }
        }, 5, 5);
        sawmillProp.tt = Scheduler.addTimeTask(function(){
            if (electricity[0] &gt;= world.sawmillProp.costE &amp;&amp; woods[0] &lt; woods[1]){
                woods[0] += sawmillProp.at * sawmillProp.prodW;
                if (woods[0] &gt; woods[1]) woods[0] = woods[1];
                electricity[0] -= sawmillProp.at * sawmillProp.costE;
            }
        }, 5, 5);
        quarryProp.tt = Scheduler.addTimeTask(function(){
            if (electricity[0] &gt;= world.quarryProp.costE &amp;&amp; stones[0] &lt; stones[1]){
                stones[0] += quarryProp.at * quarryProp.prodS;
                if (stones[0] &gt; stones[1]) stones[0] = stones[1];
                electricity[0] -= quarryProp.at * quarryProp.costE;
            }
        }, 5, 5);
        powerplantProp.tt = Scheduler.addTimeTask(function(){
            if(electricity[0] &lt;= electricity[1]) electricity[0] += powerplantProp.at * powerplantProp.prodE;
        }, 5, 5);
    }
}
</code></pre>
<hr />
<details>
    <summary>Code Explanation</summary>
<ol>
<li>We create timetask for each building type, this is done by <code>kha.Scheduler.addTimeTask(*func*, *start*, *period*, *duration*)</code>, where <code>func</code> is function done in this time task, <code>start</code> is time to wait for first <code>func</code> execution, <code>period</code> is time interval between <code>func</code> execution, <code>duration</code>, is total amount of time this time task exist for, '0' means infinite amount of time and is set defaultly.</li>
<li>We than check if there is sufficient electricity, than check if the resource is less than max, if so than let it produce the resource. Then we will check if resource is more than max resource if so, than set resource as max resources(This works as clamping and to prevent money overflowing).Then multiply no. of building by building's electricity cost and subtract the product from electricity amount.</li>
</ol>
</details>
<hr />
<!-- tabs:end -->
<hr />
<h2><a class="header" href="#canvas-1" id="canvas-1">CANVAS</a></h2>
<p>We will use <code>Canvas</code> to display our resources with progress bars.</p>
<ol>
<li>Create new canvas <code>MainCanvas</code> and uncheck it, we will use this as our main canvas, we will have other UI such as menus in here.</li>
</ol>
<p>In <code>MainCanvas</code>, create:</p>
<ol>
<li>
<p><code>Text</code> element:</p>
<ol>
<li><code>Name</code>: money. <code>Text</code>: Money</li>
<li><code>Name</code>: wood. <code>Text</code>: Wood</li>
<li><code>Name</code>: stone. <code>Text</code>: Stone</li>
<li><code>Name</code>: electricity. <code>Text</code>: Electricity</li>
<li><code>Name</code>: money-amt, wood-amt, stone-amt, electricity-amt. <code>Text</code>: 0/100</li>
</ol>
</li>
<li>
<p><code>RectPB</code> element:</p>
<ol>
<li><code>Name</code>: moneypb, woodpb, stonepb, electricitypb. <code>Progress</code>: 0. <code>Total progress</code>: 100</li>
</ol>
</li>
</ol>
<p><img src="GameDemo/CitySim/../../CBS_2_1.png" alt="Some Image" /></p>
<hr />
<p>On to the script, to control the amount and progress bars.</p>
<ol>
<li>Create new Haxe trait <code>MainCanvasController</code></li>
</ol>
<!-- tabs:start -->
<h4><a class="header" href="#maincanvascontrollerhx" id="maincanvascontrollerhx"><strong>MainCanvasController.hx</strong></a></h4>
<pre><code class="language-haxe">package arm;

import armory.trait.internal.CanvasScript;
import iron.Scene;
import arm.WorldController;

class MainCanvasController extends iron.Trait {

    static var maincanvas:CanvasScript;
    var world = WorldController;

    public function new() {
        super();
        notifyOnInit(function() {
            //Set canvas on init
            maincanvas = new CanvasScript(&quot;MainCanvas&quot;, &quot;Big_shoulders_text.ttf&quot;);
            maincanvas.setCanvasVisibility(true);
        });
        notifyOnUpdate(updateCanvas);
    }

    function updateCanvas() {
        //Update PB and Amount
        updatePB();
        updateAmount();
    }
    function updatePB() {
        //Set progress bar elements's 'at' and 'total'
        maincanvas.getElement(&quot;moneypb&quot;).progress_total = world.money[1];
        maincanvas.getElement(&quot;moneypb&quot;).progress_at = world.money[0];
        maincanvas.getElement(&quot;woodpb&quot;).progress_total = world.woods[1];
        maincanvas.getElement(&quot;woodpb&quot;).progress_at = world.woods[0];
        maincanvas.getElement(&quot;stonepb&quot;).progress_total = world.stones[1];
        maincanvas.getElement(&quot;stonepb&quot;).progress_at = world.stones[0];
        maincanvas.getElement(&quot;electricitypb&quot;).progress_total = world.electricity[1];
        maincanvas.getElement(&quot;electricitypb&quot;).progress_at = world.electricity[0];
    }
    function updateAmount() {
        //Set amount text element's text to 'resource/totalresource'
        maincanvas.getElement(&quot;money-amt&quot;).text = world.money[0] + &quot;/&quot; + world.money[1];
        maincanvas.getElement(&quot;wood-amt&quot;).text = world.woods[0] + &quot;/&quot; + world.woods[1];
        maincanvas.getElement(&quot;stone-amt&quot;).text = world.stones[0] + &quot;/&quot; + world.stones[1];
        maincanvas.getElement(&quot;electricity-amt&quot;).text = world.electricity[0] + &quot;/&quot; + world.electricity[1];
    }
}

</code></pre>
<hr />
<details>
    <summary><strike>Code Explanation</strike></summary>
<p><em>(Nothing to explain here as code say itself)</em></p>
</details>
<hr />
<!-- tabs:end -->
<hr />
<p>Putting it all together and you should get something like this:</p>
<p><img src="GameDemo/CitySim/../../CBS_2_2.gif" alt="Some Image" title=":size=400" /></p>
<p><strong>ðŸŽ‰ And We did it! We completed resources part! ðŸŽ‰</strong></p>
<hr />
<p>If you have any problem then you can check the source code at <a href="https://github.com/BlackGoku36/CBST-A3D">CBST-A3D</a></p>
<hr />
<blockquote style="border-color: #DA0B50;">
    <p>
    W.I.P.
    </p>
</blockquote>
<h2><a class="header" href="#user-interface-ui" id="user-interface-ui">User Interface (UI)</a></h2>
<hr />
<p>We will create UI in which player will have to rely less on keybinds, that is we will create menu, which will let use spawn any building type of any category easily, create other menus such as settings or layout edit and also interact with buildings with 3D UI.</p>
<p>This will be split in 2 parts:</p>
<ul>
<li>Main Menu UI: This will have placing of building from menu, settings and layout edit.</li>
<li>3D Menu UI: This will 3D UI that interact with building (such as moving, removing, etc).</li>
</ul>
<h3><a class="header" href="#main-menu-ui" id="main-menu-ui">Main Menu UI</a></h3>
<p>We will be creating main menu UI, we should be able to select building that we desire to place and also able to access other things such as settings, layout edit, etc.</p>
<p>Let's get started!</p>
<ol>
<li>
<p>Open <code>MainCanvas</code> in <code>Armory2D</code> that was created in previous tutorial and add some elements:</p>
<ul>
<li><code>Empty</code>:
<ul>
<li><code>menu_empty</code>: We will use this as parent, so that we can make child element visible and invisible easily.</li>
</ul>
</li>
<li><code>Text</code>:
<ul>
<li><code>menu_text</code>: We will use this as label for our menu button.</li>
</ul>
</li>
<li><code>Button</code>:
<ul>
<li><code>settings_btn</code>: Toggle settings</li>
<li><code>edit_btn</code>: Go in edit layout mode</li>
<li><code>house_btn</code>: Toggle house building menu</li>
<li><code>factory_btn</code>: Toggle factory building menu</li>
<li><code>community_btn</code>: Toggle community building menu</li>
</ul>
</li>
<li><code>Rect</code>:
<ul>
<li><code>menu_rect</code>: Just for style</li>
</ul>
</li>
<li><code>Fill Rect</code>:
<ul>
<li><code>menu_bg</code>: act as background for menu buttons</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Now parent following elements to <code>menu_empty</code>:</p>
<ul>
<li><code>menu_bg</code></li>
<li><code>settings_btn</code></li>
<li><code>edit_btn</code></li>
<li><code>house_btn</code></li>
<li><code>factory_btn</code></li>
<li><code>community_btn</code></li>
</ul>
</li>
<li>
<p>Now add events to buttons:</p>
<ul>
<li><code>settings_btn</code>: <code>settings_btn</code></li>
<li><code>edit_btn</code>: <code>edit_btn</code></li>
<li><code>house_btn</code>: <code>house_btn</code></li>
<li><code>factory_btn</code>: <code>factory_btn</code></li>
<li><code>community_btn</code>: <code>community_btn</code></li>
</ul>
</li>
</ol>
<p><img src="GameDemo/CitySim/../../CBS_3_1.png" alt="Some Image" /></p>
<blockquote style="border-color: #2c93c4;">
    <p>
    To parent any element, select the child element and the right click-hold the element and left click the parent element.
    </p>
</blockquote>
<p>Now to add Main menu hiding and showing:</p>
<!-- tabs:start -->
<h4><a class="header" href="#mainmenucontrollerhx" id="mainmenucontrollerhx"><strong>MainMenuController.hx</strong></a></h4>
<pre><code class="language-haxe">package arm;

import armory.trait.internal.CanvasScript;
import armory.system.Event;

import arm.WorldController;

class MainCanvasController extends iron.Trait {

    static var maincanvas:CanvasScript;

    var world = WorldController;

    //State of menu, 0 -&gt; closed, 1 -&gt; opened
    var menuState = 0;

    public function new() {
        super();

        notifyOnInit(init);
        notifyOnUpdate(updateCanvas);
    }

    function init() {
        maincanvas = new CanvasScript(&quot;MainCanvas&quot;, &quot;Big_shoulders_text.ttf&quot;);

        maincanvas.setCanvasVisibility(true);
        //Set menu_empty to invisible
        maincanvas.getElement(&quot;menu_empty&quot;).visible = false;
        //On 'menu_btn' event
        Event.add(&quot;menu_btn&quot;, function(){
            //If closed
            if (menuState == 0){
                // Set menu_empty to visible
                maincanvas.getElement(&quot;menu_empty&quot;).visible = true;
                // menu is open
                menuState = 1;
            //If opened
            }else if (menuState == 1){
                //Set menu_empty to invisible
                maincanvas.getElement(&quot;menu_empty&quot;).visible = false;
                // menu is close
                menuState = 0;
            }
        });
    }

    function updateCanvas() { ~ }
    function updatePB(){ ~ }
    function updateAmount(){ ~ }
}
</code></pre>
<hr />
<details>
    <summary>Code Explanation</summary>
<ol>
<li>We first set menuState to closed when declared</li>
<li>Every time we receive <code>menu_btn</code> event(i.e., <code>menu_btn</code> is pressed). We check if menu is closed, if it is then we show <code>menu_empty</code>(i.e, show all menu buttons) and set <code>menuState</code> to opened. Else if <code>menu_btn</code> is open than we do opposite.</li>
</ol>
</details>
<hr />
<!-- tabs:end -->
<p>On playing, you should get:</p>
<p><img src="GameDemo/CitySim/../../CBS_3_2.gif" alt="Some Image" /></p>
<hr />
<p>Now, we will add building menu. Here you should be able to select whatever building you want to spawn.</p>
<ol>
<li>
<p>Add more element to <code>MainCanvas</code>:</p>
<ul>
<li><code>Empty</code>:
<ul>
<li><code>bld_menu</code>: We will use this as parent, so that we can make child element visible and invisible easily.</li>
</ul>
</li>
<li><code>Text</code>:
<ul>
<li><code>bld_menu_text</code>: We will use this as label for our building category.</li>
</ul>
</li>
<li><code>Button</code>:
<ul>
<li><code>bld_menu_btn_1</code>: Spawn 1<sup>st</sup> building type from given category</li>
<li><code>bld_menu_btn_2</code>: Spawn 2<sup>st</sup> building type from given category</li>
<li><code>bld_menu_btn_3</code>: Spawn 3<sup>st</sup> building type from given category</li>
<li><code>bld_menu_btn_4</code>: Spawn 4<sup>st</sup> building type from given category</li>
</ul>
</li>
<li><code>Fill Rect</code>:
<ul>
<li><code>bld_menu_bg</code>: Just for style</li>
<li><code>bld_menu_hr</code>: Just for style</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Now parent following elements to <code>menu_empty</code>:</p>
<ul>
<li><code>bld_menu_bg</code></li>
<li><code>bld_menu_hr</code></li>
<li><code>bld_menu_text</code></li>
<li><code>bld_menu_btn_1</code></li>
<li><code>bld_menu_btn_2</code></li>
<li><code>bld_menu_btn_3</code></li>
<li><code>bld_menu_btn_4</code></li>
</ul>
</li>
<li>
<p>Now add events to buttons:</p>
<ul>
<li><code>bld_menu_btn_1</code>: <code>bld_menu_btn_1</code></li>
<li><code>bld_menu_btn_2</code>: <code>bld_menu_btn_2</code></li>
<li><code>bld_menu_btn_3</code>: <code>bld_menu_btn_3</code></li>
<li><code>bld_menu_btn_4</code>: <code>bld_menu_btn_4</code></li>
</ul>
</li>
</ol>
<p><img src="GameDemo/CitySim/../../CBS_3_3.png" alt="Some Image" /></p>
<p>We will break building type in 3 categories, that is, <code>House</code>, <code>Factory</code>, <code>Community</code>.</p>
<p>Now, let's get to code.</p>
<!-- tabs:start -->
<h4><a class="header" href="#maincanvascontrollerhx-1" id="maincanvascontrollerhx-1"><strong>MainCanvasController.hx</strong></a></h4>
<pre><code class="language-haxe">package arm;
~
class MainCanvasController extends iron.Trait {

    static var maincanvas:CanvasScript;

    var world = WorldController;
    var bld = BuildingController;

    var menuState = 0;
    //0 -&gt; no button, 1 -&gt; Settings button, 2 -&gt; Edit layout button
    //3 -&gt; House button, 4 -&gt; Factory button, 5 -&gt; community button
    var bldMenuBtn = 0;
    // 0 -&gt; closed bld menu, 3 -&gt; House bld menu, 4 -&gt; Factory bld menu, 5 -&gt; Community bld menu
    var bldMenuState = 0;

    public function new() { ~ }

    function init() {
        ~
        Event.add(&quot;menu_btn&quot;, function(){
            if (menuState == 0){
                maincanvas.getElement(&quot;menu_empty&quot;).visible = true;
                menuState = 1;
                // Close/reset bld menu
                bldMenuState = 0;
            }else if (menuState == 1){ ~ }
        });

        //Check bldMenuState and set bldMenuState to corresponding building.
        Event.add(&quot;house_btn&quot;, function(){ bldMenuBtn = 3; bldMenuState == 3 ? bldMenuState = 0 : bldMenuState = 3;});
        Event.add(&quot;factory_btn&quot;, function(){ bldMenuBtn = 4; bldMenuState == 4 ? bldMenuState = 0 : bldMenuState = 4;});
        Event.add(&quot;community_btn&quot;, function(){ bldMenuBtn = 5; bldMenuState == 5 ? bldMenuState = 0 : bldMenuState = 5;});

        //Check when bld_menu_btn_n, and spawn building corresponding to category and type
        Event.add(&quot;bld_menu_btn_1&quot;, function(){
            switch (bldMenuState){
                case 3: bld.spawnBuilding(1);
                case 4: bld.spawnBuilding(5);
                case 5: bld.spawnBuilding(2);
            }
        });
        Event.add(&quot;bld_menu_btn_2&quot;, function(){
            switch (bldMenuState){
                case 4: bld.spawnBuilding(6);
                case 5: bld.spawnBuilding(3);
            }
        });
        Event.add(&quot;bld_menu_btn_3&quot;, function(){
            switch (bldMenuState){
                case 4: bld.spawnBuilding(7);
                case 5: bld.spawnBuilding(4);
            }
        });
        Event.add(&quot;bld_menu_btn_4&quot;, function(){
            switch (bldMenuState){
                case 4: bld.spawnBuilding(8);
            }
        });
    }

    function updateCanvas() {
        updatePB();
        updateAmount();

        //Check if bldMenuBtn and set text and visibility according to it.
        if(bldMenuState == 3 || bldMenuState == 4 || bldMenuState == 5){
            maincanvas.getElement(&quot;bld_menu_text&quot;).text = getCategoryFromInt(bldMenuBtn);
            maincanvas.getElement(&quot;bld_menu&quot;).visible = true;
        }
        if (bldMenuState == 0 || menuState == 0){
            maincanvas.getElement(&quot;bld_menu&quot;).visible = false;
        }

        //Switch between bldMenuBtn and set button's text and visibility.
        switch (bldMenuState){
            case 3:
                maincanvas.getElement(&quot;bld_menu_btn_1&quot;).text =  &quot;House&quot;;
                maincanvas.getElement(&quot;bld_menu_btn_1&quot;).visible = true;
                maincanvas.getElement(&quot;bld_menu_btn_2&quot;).visible = false;
                maincanvas.getElement(&quot;bld_menu_btn_3&quot;).visible = false;
                maincanvas.getElement(&quot;bld_menu_btn_4&quot;).visible = false;
            case 4:
                maincanvas.getElement(&quot;bld_menu_btn_1&quot;).text =  &quot;Sawmill&quot;;
                maincanvas.getElement(&quot;bld_menu_btn_1&quot;).visible = true;
                maincanvas.getElement(&quot;bld_menu_btn_2&quot;).text =  &quot;Quarry&quot;;
                maincanvas.getElement(&quot;bld_menu_btn_2&quot;).visible = true;
                maincanvas.getElement(&quot;bld_menu_btn_3&quot;).text =  &quot;Steelworks&quot;;
                maincanvas.getElement(&quot;bld_menu_btn_3&quot;).visible = true;
                maincanvas.getElement(&quot;bld_menu_btn_4&quot;).text =  &quot;Powerplant&quot;;
                maincanvas.getElement(&quot;bld_menu_btn_4&quot;).visible = true;
            case 5:
                maincanvas.getElement(&quot;bld_menu_btn_1&quot;).text =  &quot;Park&quot;;
                maincanvas.getElement(&quot;bld_menu_btn_1&quot;).visible = true;
                maincanvas.getElement(&quot;bld_menu_btn_2&quot;).text =  &quot;Garden&quot;;
                maincanvas.getElement(&quot;bld_menu_btn_2&quot;).visible = true;
                maincanvas.getElement(&quot;bld_menu_btn_3&quot;).text =  &quot;Sport.C.&quot;;
                maincanvas.getElement(&quot;bld_menu_btn_3&quot;).visible = true;
                maincanvas.getElement(&quot;bld_menu_btn_4&quot;).visible = false;
        }
    }

    function updatePB() { ~ }
    function updateAmount() { ~ }

    //Get building category from int
    static function getCategoryFromInt(int: Int):String {
        var type = &quot;&quot;;
        switch (int){
            case 3: type = &quot;House&quot;;
            case 4: type = &quot;Factory&quot;;
            case 5: type = &quot;Community&quot;;
        }
        return type;
    }
}

</code></pre>
<hr />
<details>
    <summary>Code Explanation</summary>
<ol>
<li>In <code>menu_btn</code> event, We will first check if menu is opened, if so than we close/reset building menu.</li>
<li>In <code>&lt;category&gt;_btn</code> event, We will first set <code>bldMenuBtn</code> to its corresponding. We will than check if <code>bldMenuState</code> is same as corresponding button, if so then we set <code>bldMenuState</code> to 0 or else set <code>bldMenuState</code> to it corresponding button.</li>
<li>In <code>updateCanvas()</code>, we will switch between <code>bldMenuState</code> and set buttons text and visibility according to it.</li>
<li>In <code>updateCanvas()</code>, we will check if <code>bldMenuState</code> equals to any building category. If so, than set <code>bld_menu_text</code> text and set <code>bld_menu</code> visible</li>
<li>In <code>updateCanvas()</code>, we will check if <code>bldMenuState</code> or <code>menuState</code> is closed. If so, than set <code>bld_menu</code> to invisible.</li>
<li>In <code>getCategoryFromInt()</code>, we will switch between the int and then return corresponding text.</li>
<li>In <code>bld_menu_btn_&lt;n&gt;</code> event, we will switch between <code>bldMenuState</code> and spawn building corresponding to category and type.</li>
</ol>
</details>
<hr />
<!-- tabs:end -->
<hr />
<p>Now, you should get like:</p>
<p><img src="GameDemo/CitySim/../../CBS_3_4.gif" alt="Some Image" /></p>
<h2><a class="header" href="#faq" id="faq">FAQ</a></h2>
<hr />
<details>
    <summary>WHY TUTORIAL FOR CBS GAME, NOT FPS OR SOMETHING ELSE?</summary>
<p>You might be wondering, why tutorial for CBS game in particular and not something like FPS game? Well, that because of following reasons:</p>
<ul>
<li>
<p><strong>Boringgggg!!!</strong>: FPS game tutorial are really common type of tutorial among game dev community, I mean there already exists video and text tutorial for <code>Armory3D</code> game engine. so, I find it boring to create another one.</p>
</li>
<li>
<p><strong>Unique</strong>: Tutorial for CBS game are rare, some people might be wondering about how it work inside, so I thought why not.</p>
</li>
<li>
<p><strong>Simple</strong>: Small CBS game are simple enough to make and understand.</p>
</li>
</ul>
</details>
<hr />
<details>
    <summary>I HAVE PROBLEM WITH THIS TUTORIAL, WHAT CAN I DO?</summary>
<p>You can:</p>
<ul>
<li>Ask on Armory's <a href="http://forums.armory3d.org/">forums</a>, <a href="https://discordapp.com/invite/axq6qWV">discord server</a> and mention <code>@BlackGoku36</code></li>
<li>Create github issue <a href="https://github.com/BlackGoku36/armory-tutorials/issues">here</a></li>
</ul>
<p>Feel free to ask anything!</p>
</details>
<hr />
<details>
    <summary>YOUR TUTORIALS ARE GOOD! MIND IF I TRANSLATE IT TO OTHER LANGUAGE?</summary>
<p style="margin-left: 35px">Yes, you can translate it to whatever language you want, whether it is `Gujarati`, `Hindi`, `Japanese`, `Portuguese`, or even `MC enchanting table language`, feel free to do so. The only thing you gotta do is credit me and not claim yourself as original author, other than that, you are good.</p>
</details>
<hr />
<h1><a class="header" href="#how-to-read" id="how-to-read">How-to read</a></h1>
<p>This is text that you have to read in order to understand what is going on.</p>
<p>Boring right? I know.</p>
<details>
<summary> I am expandable</summary>
<p><a href="https://upload.wikimedia.org/wikipedia/en/7/76/Expendablesposter.jpg">Some expandables contents.</a></p>
</details>
<pre><code class="language-hx">// This is code example. Click 2 paper icon to copy code, if you are pathetic human. -&gt;
var you = &quot;cute&quot;;
</code></pre>
<pre><pre class="playpen"><code class="language-rust">/* Playable rust code. Kinda cool right?
    Carry on, it doesn't support haxe*/
fn main(){
    println!(&quot;Hey there!&quot;);
}
</code></pre></pre>
<p>Some information blocks:</p>
<blockquote style="border-color: #DA0B50;">
    <p>
    This is dangerous, stay away if you can.
    </p>
</blockquote>
<blockquote style="border-color: #FF9E1F;">
    <p>
    This is warning, don't tell me that I didn't warn you.
    </p>
</blockquote>
<blockquote style="border-color: #2c93c4;">
    <p>
    Information that even illuminati doesn't have.
    </p>
</blockquote>
<blockquote style="border-color: #30ca54;">
    <p>
    This is success, yay!
    </p>
</blockquote>
<h1><a class="header" href="#faq-1" id="faq-1">FAQ</a></h1>
<details>
    <summary>I HAVE PROBLEM WITH THIS TUTORIAL, WHAT CAN I DO?</summary>
<p>You can:</p>
<ul>
<li>Ask on Armory's <a href="http://forums.armory3d.org/">forums</a>, <a href="https://discordapp.com/invite/axq6qWV">discord server</a> and mention <code>@BlackGoku36</code></li>
<li>Create github issue <a href="https://github.com/BlackGoku36/armory-tutorials/issues">here</a></li>
</ul>
<p>Feel free to ask anything!</p>
</details>
<hr />
<details>
    <summary>YOUR TUTORIALS ARE GOOD! MIND IF I TRANSLATE IT TO OTHER LANGUAGE?</summary>
<p style="margin-left: 35px">Yes, you can translate it to whatever language you want, whether it is `Gujarati`, `Hindi`, `Japanese`, `Portuguese`, or even `MC enchanting table language`, feel free to do so. The only thing you gotta do is credit me and not claim yourself as original author, other than that, you are good.</p>
</details>
<hr />

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
